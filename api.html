<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />

        <title>Audiolet API Documentation</title>

        <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Inconsolata&amp;v1" />
        <link rel="stylesheet" href="css/museo-sans/stylesheet.css" />

        <link rel="stylesheet" href="css/html5reset-1.6.1.css" />
        <link rel="stylesheet" href="css/pygments/tango.css" />
        <link rel="stylesheet" href="css/oxo.css" />

        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
        <script src="js/jquery.EqualHeights.js"></script>
        <script src="js/oxo.js"></script>
    </head>
    <body>
        <div id="container"> 
            <!-- Documentation title and description -->
            <div id="title">
                <div class="header block">
                    <div class="left">
                        <div>
                            <h1>
                                Audiolet API Documentation
                            </h1>
                            <p>JavaScript library for audio synthesis and composition.</p>

                        </div>
                    </div>
                    <div class="right">
                        <div>&nbsp;</div>
                    </div>
                    <div class="clear"></div>
                </div>
            </div>

            <!-- Single files -->
            

            <!-- Sections -->
            <div class="section">
                <div class="header block">
                    <div class="left">
                        <div>
                            <h2>Core</h2>
                        </div>
                    </div>
                    <div class="right">
                        <div><p>Core Audiolet classes</p>
</div>
                    </div>
                    <div class="clear"></div>
                </div>

                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Audiolet</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/core/Audiolet.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>The base audiolet object.  Contains an output node which pulls data from
connected nodes.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [sampleRate=44100] The sample rate to run at.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [numberOfChannels=2] The number of output channels.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [bufferSize] Block size. If undefined uses a sane default.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Audiolet</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">sampleRate</span><span class="p">,</span> <span class="nx">numberOfChannels</span><span class="p">,</span> <span class="nx">bufferSize</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">output</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletDestination</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">sampleRate</span><span class="p">,</span>
                                          <span class="nx">numberOfChannels</span><span class="p">,</span> <span class="nx">bufferSize</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>AudioletNode</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/core/AudioletNode.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>The basic building block of Audiolet applications.  Nodes are connected
together to create a processing graph which governs the flow of audio data.
AudioletNodes can contain any number of inputs and outputs which send and
receive one or more channels of audio data.  Audio data is created and
processed using the generate function, which is called whenever new data is
needed.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> numberOfInputs The number of inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> numberOfOutputs The number of outputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Function</em> [generate] A replacement for the generate function.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">AudioletNode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">numberOfInputs</span><span class="p">,</span> <span class="nx">numberOfOutputs</span><span class="p">,</span>
                            <span class="nx">generate</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span> <span class="o">=</span> <span class="nx">audiolet</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">numberOfInputs</span> <span class="o">=</span> <span class="nx">numberOfInputs</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">numberOfOutputs</span> <span class="o">=</span> <span class="nx">numberOfOutputs</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">numberOfInputs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">numberOfInputs</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfInputs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">AudioletInput</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">i</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">numberOfOutputs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">numberOfOutputs</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfOutputs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">AudioletOutput</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">i</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">generate</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="nx">generate</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">timestamp</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Connect the node to another node or group.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletNode|AudioletGroup</em> node The node to connect to.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [output=0] The index of the output to connect from.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [input=0] The index of the input to connect to.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">connect</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">output</span><span class="p">,</span> <span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">node</span> <span class="k">instanceof</span> <span class="nx">AudioletGroup</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Connect to the pass-through node rather than the group</span>
        <span class="nx">node</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="nx">input</span> <span class="o">||</span> <span class="mi">0</span><span class="p">];</span>
        <span class="nx">input</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">outputPin</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">[</span><span class="nx">output</span> <span class="o">||</span> <span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">inputPin</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="nx">input</span> <span class="o">||</span> <span class="mi">0</span><span class="p">];</span>
    <span class="nx">outputPin</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">inputPin</span><span class="p">);</span>
    <span class="nx">inputPin</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">outputPin</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Disconnect the node from another node or group</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletNode|AudioletGroup</em> node The node to disconnect from.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [output=0] The index of the output to disconnect.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [input=0] The index of the input to disconnect.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">disconnect</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">output</span><span class="p">,</span> <span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">node</span> <span class="k">instanceof</span> <span class="nx">AudioletGroup</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">node</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="nx">input</span> <span class="o">||</span> <span class="mi">0</span><span class="p">];</span>
        <span class="nx">input</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">outputPin</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">[</span><span class="nx">output</span> <span class="o">||</span> <span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">inputPin</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="nx">input</span> <span class="o">||</span> <span class="mi">0</span><span class="p">];</span>
    <span class="nx">inputPin</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">(</span><span class="nx">outputPin</span><span class="p">);</span>
    <span class="nx">outputPin</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">(</span><span class="nx">inputPin</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Force an output to contain a fixed number of channels.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> output The index of the output.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> numberOfChannels The number of channels.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setNumberOfOutputChannels</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">output</span><span class="p">,</span>
                                                            <span class="nx">numberOfChannels</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">[</span><span class="nx">output</span><span class="p">].</span><span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">numberOfChannels</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Link an output to an input, forcing the output to always contain the
same number of channels as the input.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> output The index of the output.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> input The index of the input.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">output</span><span class="p">,</span> <span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">[</span><span class="nx">output</span><span class="p">].</span><span class="nx">linkNumberOfChannels</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="nx">input</span><span class="p">]);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a buffer of samples, first pulling any necessary data from
higher up the processing graph.  This function should not be called
manually by users, who should instead rely on automatic ticking from
connections to the AudioletDevice.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> length The number of samples to process.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> timestamp A timestamp for the block of samples.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">tick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">length</span><span class="p">,</span> <span class="nx">timestamp</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">timestamp</span> <span class="o">!=</span> <span class="k">this</span><span class="p">.</span><span class="nx">timestamp</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Need to set the timestamp before we tick the parents so we</span>
        <span class="c1">// can&#39;t get into infinite loops where there is feedback in the</span>
        <span class="c1">// graph</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">timestamp</span> <span class="o">=</span> <span class="nx">timestamp</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">tickParents</span><span class="p">(</span><span class="nx">length</span><span class="p">,</span> <span class="nx">timestamp</span><span class="p">);</span>

        <span class="kd">var</span> <span class="nx">inputBuffers</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">createInputBuffers</span><span class="p">(</span><span class="nx">length</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">outputBuffers</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">createOutputBuffers</span><span class="p">(</span><span class="nx">length</span><span class="p">);</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">generate</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Call the tick function on nodes which are connected to the inputs.  This
function should not be called manually by users.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> length The number of samples to process.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> timestamp A timestamp for the block of samples.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">tickParents</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">length</span><span class="p">,</span> <span class="nx">timestamp</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">numberOfInputs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">numberOfInputs</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfInputs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">input</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="kd">var</span> <span class="nx">numberOfStreams</span> <span class="o">=</span> <span class="nx">input</span><span class="p">.</span><span class="nx">connectedFrom</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="c1">// Tick backwards, as the input may disconnect itself during the</span>
        <span class="c1">// loop</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfStreams</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">numberOfStreams</span> <span class="o">-</span> <span class="nx">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
            <span class="nx">input</span><span class="p">.</span><span class="nx">connectedFrom</span><span class="p">[</span><span class="nx">index</span><span class="p">].</span><span class="nx">node</span><span class="p">.</span><span class="nx">tick</span><span class="p">(</span><span class="nx">length</span><span class="p">,</span> <span class="nx">timestamp</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples, reading from the input buffers and putting
new values into the output buffers.  Override me!</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Sane default - pass along any empty flags</span>
    <span class="kd">var</span> <span class="nx">numberOfInputs</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">numberOfOutputs</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfInputs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfOutputs</span> <span class="o">&amp;&amp;</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">outputBuffers</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Create the input buffers by grabbing data from the outputs of connected
nodes and summing it.  If no nodes are connected to an input, then
give a one channel empty buffer.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> length The number of samples for the resulting buffers.
                                    </li>
                                    <li>
                                        <strong>return</strong> <em>AudioletBuffer[]</em> The input buffers.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">createInputBuffers</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffers</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">numberOfInputs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">numberOfInputs</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfInputs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">input</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>

        <span class="c1">// Find the non-empty output with the most channels</span>
        <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">largestOutput</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">connectedFrom</span> <span class="o">=</span> <span class="nx">input</span><span class="p">.</span><span class="nx">connectedFrom</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">numberOfConnections</span> <span class="o">=</span> <span class="nx">connectedFrom</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfConnections</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">output</span> <span class="o">=</span> <span class="nx">connectedFrom</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">output</span><span class="p">.</span><span class="nx">buffer</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span> <span class="o">&gt;</span> <span class="nx">numberOfChannels</span> <span class="o">&amp;&amp;</span>
                <span class="o">!</span><span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
                <span class="nx">largestOutput</span> <span class="o">=</span> <span class="nx">output</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">largestOutput</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// TODO: Optimizations</span>
            <span class="c1">// We have non-empty connections</span>

            <span class="c1">// Resize the input buffer accordingly</span>
            <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">input</span><span class="p">.</span><span class="nx">buffer</span><span class="p">;</span>
            <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">resize</span><span class="p">(</span><span class="nx">numberOfChannels</span><span class="p">,</span> <span class="nx">length</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
            <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

            <span class="c1">// Set the buffer using the largest output</span>
            <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">largestOutput</span><span class="p">.</span><span class="nx">getBuffer</span><span class="p">(</span><span class="nx">length</span><span class="p">));</span>

            <span class="c1">// Sum the rest of the outputs</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfConnections</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">output</span> <span class="o">=</span> <span class="nx">connectedFrom</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">output</span> <span class="o">!=</span> <span class="nx">largestOutput</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">output</span><span class="p">.</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">output</span><span class="p">.</span><span class="nx">getBuffer</span><span class="p">(</span><span class="nx">length</span><span class="p">));</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="nx">inputBuffers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">inputBuffer</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="c1">// If we don&#39;t have any non-empty connections give a single</span>
            <span class="c1">// channel empty buffer of the correct length</span>
            <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">input</span><span class="p">.</span><span class="nx">buffer</span><span class="p">;</span>
            <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">resize</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">length</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
            <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="nx">inputBuffers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">inputBuffer</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">inputBuffers</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Create output buffers of the correct length.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> length The number of samples for the resulting buffers.
                                    </li>
                                    <li>
                                        <strong>return</strong> <em>AudioletNode[]</em> The output buffers.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">createOutputBuffers</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Create the output buffers</span>
    <span class="kd">var</span> <span class="nx">outputBuffers</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">numberOfOutputs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">numberOfOutputs</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfOutputs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">output</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="nx">output</span><span class="p">.</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">resize</span><span class="p">(</span><span class="nx">output</span><span class="p">.</span><span class="nx">getNumberOfChannels</span><span class="p">(),</span> <span class="nx">length</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="nx">output</span><span class="p">.</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="nx">outputBuffers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">output</span><span class="p">.</span><span class="nx">buffer</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">outputBuffers</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Remove the node completely from the processing graph, disconnecting all
of its inputs and outputs.</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">remove</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Disconnect inputs</span>
    <span class="kd">var</span> <span class="nx">numberOfInputs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfInputs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">input</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="kd">var</span> <span class="nx">numberOfStreams</span> <span class="o">=</span> <span class="nx">input</span><span class="p">.</span><span class="nx">connectedFrom</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfStreams</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">outputPin</span> <span class="o">=</span> <span class="nx">input</span><span class="p">.</span><span class="nx">connectedFrom</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">output</span> <span class="o">=</span> <span class="nx">outputPin</span><span class="p">.</span><span class="nx">node</span><span class="p">;</span>
            <span class="nx">output</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">outputPin</span><span class="p">.</span><span class="nx">index</span><span class="p">,</span> <span class="nx">i</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Disconnect outputs</span>
    <span class="kd">var</span> <span class="nx">numberOfOutputs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfOutputs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">output</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="kd">var</span> <span class="nx">numberOfStreams</span> <span class="o">=</span> <span class="nx">output</span><span class="p">.</span><span class="nx">connectedTo</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfStreams</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">inputPin</span> <span class="o">=</span> <span class="nx">output</span><span class="p">.</span><span class="nx">connectedTo</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">input</span> <span class="o">=</span> <span class="nx">inputPin</span><span class="p">.</span><span class="nx">node</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">disconnect</span><span class="p">(</span><span class="nx">input</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">inputPin</span><span class="p">.</span><span class="nx">index</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>AudioletGroup</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/core/AudioletGroup.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>A container for collections of connected AudioletNodes.  Groups make it
possible to create multiple copies of predefined networks of nodes,
without having to manually create and connect up each individual node.</p>

<p>From the outside groups look and behave exactly the same as nodes.
Internally you can connect nodes directly to the group's inputs and
outputs, allowing connection to nodes outside of the group.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> numberOfInputs The number of inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> numberOfOutputs The number of outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">AudioletGroup</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">numberOfInputs</span><span class="p">,</span> <span class="nx">numberOfOutputs</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span> <span class="o">=</span> <span class="nx">audiolet</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">numberOfInputs</span> <span class="o">=</span> <span class="nx">numberOfInputs</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">numberOfOutputs</span> <span class="o">=</span> <span class="nx">numberOfOutputs</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfInputs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">PassThroughNode</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfOutputs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">PassThroughNode</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Connect the group to another node or group</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletNode|AudioletGroup</em> node The node to connect to.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [output=0] The index of the output to connect from.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [input=0] The index of the input to connect to.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletGroup</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">connect</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">output</span><span class="p">,</span> <span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">[</span><span class="nx">output</span> <span class="o">||</span> <span class="mi">0</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">input</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Disconnect the group from another node or group</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletNode|AudioletGroup</em> node The node to disconnect from.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [output=0] The index of the output to disconnect.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [input=0] The index of the input to disconnect.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletGroup</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">disconnect</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">output</span><span class="p">,</span> <span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">[</span><span class="nx">output</span> <span class="o">||</span> <span class="mi">0</span><span class="p">].</span><span class="nx">disconnect</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">input</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Remove the group completely from the processing graph, disconnecting all
of its inputs and outputs</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletGroup</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">remove</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">numberOfInputs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfInputs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">remove</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">numberOfOutputs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfOutputs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">remove</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>AudioletBuffer</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/core/AudioletBuffer.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>A variable size multi-channel audio buffer.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> numberOfChannels The initial number of channels.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> length The length in samples of each channel.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">AudioletBuffer</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">numberOfChannels</span><span class="p">,</span> <span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="nx">length</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">channels</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">channels</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">Float32Array</span><span class="p">(</span><span class="nx">length</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">unslicedChannels</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">unslicedChannels</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">channels</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">channelOffset</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Get a single channel of data</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> channel The index of the channel.
                                    </li>
                                    <li>
                                        <strong>return</strong> <em>Float32Array</em> The requested channel.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletBuffer</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getChannelData</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">channel</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">channels</span><span class="p">[</span><span class="nx">channel</span><span class="p">]);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Set the data in the buffer by copying data from a second buffer</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer</em> buffer The buffer to copy data from.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletBuffer</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">set</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">buffer</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">channels</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">set</span><span class="p">(</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Set the data in a section of the buffer by copying data from a second buffer</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer</em> buffer The buffer to copy data from.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> length The number of samples to copy.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [inputOffset=0] An offset to read data from.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [outputOffset=0] An offset to write data to.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletBuffer</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setSection</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">buffer</span><span class="p">,</span> <span class="nx">length</span><span class="p">,</span> <span class="nx">inputOffset</span><span class="p">,</span>
                                               <span class="nx">outputOffset</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">inputOffset</span> <span class="o">=</span> <span class="nx">inputOffset</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">outputOffset</span> <span class="o">=</span> <span class="nx">outputOffset</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Begin subarray-of-subarray fix</span>
        <span class="nx">inputOffset</span> <span class="o">+=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">channelOffset</span><span class="p">;</span>
        <span class="nx">outputOffset</span> <span class="o">+=</span> <span class="k">this</span><span class="p">.</span><span class="nx">channelOffset</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">channel1</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">unslicedChannels</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">subarray</span><span class="p">(</span><span class="nx">outputOffset</span><span class="p">,</span>
                <span class="nx">outputOffset</span> <span class="o">+</span>
                <span class="nx">length</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">channel2</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">unslicedChannels</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">subarray</span><span class="p">(</span><span class="nx">inputOffset</span><span class="p">,</span>
                <span class="nx">inputOffset</span> <span class="o">+</span>
                <span class="nx">length</span><span class="p">);</span>
        <span class="c1">// End subarray-of-subarray fix</span>
        <span class="c1">// Uncomment the following lines when subarray-of-subarray is fixed</span>
        
        <span class="nx">channel1</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">channel2</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Add the data from a second buffer to the data in this buffer</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer</em> buffer The buffer to add data from.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletBuffer</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">add</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">buffer</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">length</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">channel1</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">channel2</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">channel1</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">+=</span> <span class="nx">channel2</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Add the data from a section of a second buffer to the data in this buffer</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer</em> buffer The buffer to add data from.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> length The number of samples to add.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [inputOffset=0] An offset to read data from.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [outputOffset=0] An offset to write data to.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletBuffer</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">addSection</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">buffer</span><span class="p">,</span> <span class="nx">length</span><span class="p">,</span> <span class="nx">inputOffset</span><span class="p">,</span>
                                               <span class="nx">outputOffset</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">inputOffset</span> <span class="o">=</span> <span class="nx">inputOffset</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">outputOffset</span> <span class="o">=</span> <span class="nx">outputOffset</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">channel1</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">channel2</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">channel1</span><span class="p">[</span><span class="nx">j</span> <span class="o">+</span> <span class="nx">outputOffset</span><span class="p">]</span> <span class="o">+=</span> <span class="nx">channel2</span><span class="p">[</span><span class="nx">j</span> <span class="o">+</span> <span class="nx">inputOffset</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Resize the buffer.  This operation can optionally be lazy, which is
generally faster but doesn't necessarily result in an empty buffer.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> numberOfChannel The new number of channels.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> length The new length of each channel.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Boolean</em> [lazy=false] If true a resized buffer may not be empty.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [offset=0] An offset to resize from.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletBuffer</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">resize</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">numberOfChannels</span><span class="p">,</span> <span class="nx">length</span><span class="p">,</span> <span class="nx">lazy</span><span class="p">,</span>
                                           <span class="nx">offset</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">offset</span> <span class="o">=</span> <span class="nx">offset</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
    <span class="c1">// Local variables</span>
    <span class="kd">var</span> <span class="nx">channels</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">channels</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">unslicedChannels</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">unslicedChannels</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">oldLength</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">channelOffset</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">channelOffset</span> <span class="o">+</span> <span class="nx">offset</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Get the current channels</span>
        <span class="kd">var</span> <span class="nx">channel</span> <span class="o">=</span> <span class="nx">channels</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="kd">var</span> <span class="nx">unslicedChannel</span> <span class="o">=</span> <span class="nx">unslicedChannels</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="nx">oldLength</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// We are increasing the size of the buffer</span>
            <span class="kd">var</span> <span class="nx">oldChannel</span> <span class="o">=</span> <span class="nx">channel</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">lazy</span> <span class="o">||</span>
                <span class="o">!</span><span class="nx">unslicedChannel</span> <span class="o">||</span>
                <span class="nx">unslicedChannel</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// Unsliced channel is not empty when it needs to be,</span>
                <span class="c1">// does not exist, or is not large enough, so needs to be</span>
                <span class="c1">// (re)created</span>
                <span class="nx">unslicedChannel</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Float32Array</span><span class="p">(</span><span class="nx">length</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">channel</span> <span class="o">=</span> <span class="nx">unslicedChannel</span><span class="p">.</span><span class="nx">subarray</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">length</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">lazy</span> <span class="o">&amp;&amp;</span> <span class="nx">oldChannel</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">channel</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">oldChannel</span><span class="p">,</span> <span class="nx">offset</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">channelOffset</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="c1">// We are decreasing the size of the buffer</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">unslicedChannel</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// Unsliced channel does not exist</span>
                <span class="c1">// We can assume that we always have at least one unsliced</span>
                <span class="c1">// channel, so we can copy its length</span>
                <span class="kd">var</span> <span class="nx">unslicedLength</span> <span class="o">=</span> <span class="nx">unslicedChannels</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span>
                <span class="nx">unslicedChannel</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Float32Array</span><span class="p">(</span><span class="nx">unslicedLength</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="c1">// Begin subarray-of-subarray fix</span>
            <span class="nx">offset</span> <span class="o">=</span> <span class="nx">channelOffset</span><span class="p">;</span>
            <span class="nx">channel</span> <span class="o">=</span> <span class="nx">unslicedChannel</span><span class="p">.</span><span class="nx">subarray</span><span class="p">(</span><span class="nx">offset</span><span class="p">,</span> <span class="nx">offset</span> <span class="o">+</span> <span class="nx">length</span><span class="p">);</span>
            <span class="c1">// End subarray-of-subarray fix</span>
            <span class="c1">// Uncomment the following lines when subarray-of-subarray is</span>
            <span class="c1">// fixed.</span>
            <span class="c1">// TODO: Write version where subarray-of-subarray is used</span>
        <span class="p">}</span>
        <span class="nx">channels</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">channel</span><span class="p">;</span>
        <span class="nx">unslicedChannels</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">unslicedChannel</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">channels</span> <span class="o">=</span> <span class="nx">channels</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">numberOfChannels</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">unslicedChannels</span> <span class="o">=</span> <span class="nx">unslicedChannels</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">numberOfChannels</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="nx">length</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">channelOffset</span> <span class="o">=</span> <span class="nx">channelOffset</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Append the data from a second buffer to the end of the buffer</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer</em> buffer The buffer to append to this buffer.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletBuffer</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">push</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">buffer</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">resize</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">+</span> <span class="nx">bufferLength</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setSection</span><span class="p">(</span><span class="nx">buffer</span><span class="p">,</span> <span class="nx">bufferLength</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="nx">bufferLength</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Remove data from the end of the buffer, placing it in a second buffer.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer</em> buffer The buffer to move data into.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletBuffer</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">pop</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">buffer</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">offset</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="nx">bufferLength</span><span class="p">;</span>
    <span class="nx">buffer</span><span class="p">.</span><span class="nx">setSection</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">bufferLength</span><span class="p">,</span> <span class="nx">offset</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">resize</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">,</span> <span class="nx">offset</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Prepend data from a second buffer to the beginning of the buffer.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer</em> buffer The buffer to prepend to this buffer.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletBuffer</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">unshift</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">buffer</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">resize</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">+</span> <span class="nx">bufferLength</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nx">bufferLength</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setSection</span><span class="p">(</span><span class="nx">buffer</span><span class="p">,</span> <span class="nx">bufferLength</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Remove data from the beginning of the buffer, placing it in a second buffer.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer</em> buffer The buffer to move data into.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletBuffer</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">shift</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">buffer</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="nx">buffer</span><span class="p">.</span><span class="nx">setSection</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">bufferLength</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">resize</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="nx">bufferLength</span><span class="p">,</span>
            <span class="kc">false</span><span class="p">,</span> <span class="nx">bufferLength</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Make all values in the buffer 0</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletBuffer</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">zero</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">channel</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">length</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">channel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Copy the buffer into a single Float32Array, with each channel appended to
the end of the previous one.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>Float32Array</em> The combined array of data.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletBuffer</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">combined</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">channels</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">channels</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">length</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">combined</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Float32Array</span><span class="p">(</span><span class="nx">numberOfChannels</span> <span class="o">*</span> <span class="nx">length</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">combined</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">channels</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">i</span> <span class="o">*</span> <span class="nx">length</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">combined</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Copy the buffer into a single Float32Array, with the channels interleaved.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>Float32Array</em> The interleaved array of data.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletBuffer</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">interleaved</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">channels</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">channels</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">length</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">interleaved</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Float32Array</span><span class="p">(</span><span class="nx">numberOfChannels</span> <span class="o">*</span> <span class="nx">length</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">interleaved</span><span class="p">[</span><span class="nx">numberOfChannels</span> <span class="o">*</span> <span class="nx">i</span> <span class="o">+</span> <span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">channels</span><span class="p">[</span><span class="nx">j</span><span class="p">][</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">interleaved</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Return a new copy of the buffer.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>AudioletBuffer</em> The copy of the buffer.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletBuffer</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">copy</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">buffer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletBuffer</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
    <span class="nx">buffer</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">buffer</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Load a .wav or .aiff file into the buffer using audiofile.js</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>String</em> path The path to the file.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Boolean</em> [async=true] Whether to load the file asynchronously.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Function</em> [callback] Function called if the file loaded sucessfully.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletBuffer</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">load</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">async</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioFileRequest</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">async</span><span class="p">);</span>
    <span class="nx">request</span><span class="p">.</span><span class="nx">onSuccess</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">decoded</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="nx">decoded</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">decoded</span><span class="p">.</span><span class="nx">channels</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">unslicedChannels</span> <span class="o">=</span> <span class="nx">decoded</span><span class="p">.</span><span class="nx">channels</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">channels</span> <span class="o">=</span> <span class="nx">decoded</span><span class="p">.</span><span class="nx">channels</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">channelOffset</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">callback</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>

    <span class="nx">request</span><span class="p">.</span><span class="nx">onFailure</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Could not load&#39;</span><span class="p">,</span> <span class="nx">path</span><span class="p">);</span>
    <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>

    <span class="nx">request</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>AudioletParameter</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/core/AudioletParameter.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>AudioletParameters are used to provide either constant or varying values to
be used inside AudioletNodes.  AudioletParameters hold a static value, and
can also be linked to an AudioletInput.  If a node or group is connected to
the linked input, then the dynamic value taken from the node should be
prioritised over the stored static value.  If no node is connected then the
static value should be used.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletNode</em> node The node which the parameter is associated with.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [inputIndex] The index of the AudioletInput to link to.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [value=0] The initial static value to store.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">AudioletParameter</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">inputIndex</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">node</span> <span class="o">=</span> <span class="nx">node</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">inputIndex</span> <span class="o">!=</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">inputIndex</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">input</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="nx">inputIndex</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">input</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">value</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Check whether the static value should be used.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>Boolean</em> True if the static value should be used.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletParameter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">isStatic</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">input</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">;</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">input</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span>
            <span class="nx">input</span><span class="p">.</span><span class="nx">connectedFrom</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span>
            <span class="nx">input</span><span class="p">.</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Check whether the dynamic values should be used.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>Boolean</em> True if the dynamic values should be used.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletParameter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">isDynamic</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">input</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">;</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">input</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span>
            <span class="nx">input</span><span class="p">.</span><span class="nx">connectedFrom</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span>
            <span class="o">!</span><span class="nx">input</span><span class="p">.</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Set the stored static value</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> value The value to store.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletParameter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setValue</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Get the stored static value</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>Number</em> The stored static value.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletParameter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getValue</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Get the channel containing the dynamic values taken from the linked input</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>Float32Array</em> The channel containing the dynamic values.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletParameter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getChannel</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>AudioletInput</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/core/AudioletInput.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Class representing a single input of an AudioletNode</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletNode</em> node The node which the input belongs to.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> index The index of the input.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">AudioletInput</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">node</span> <span class="o">=</span> <span class="nx">node</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">index</span> <span class="o">=</span> <span class="nx">index</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">connectedFrom</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="c1">// Minimum sized buffer, which we can resize from accordingly</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletBuffer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="c1">// Overflow buffer, for feedback loops</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">overflow</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletBuffer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Connect the input to an output</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletOutput</em> output The output to connect to.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletInput</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">connect</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">output</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">connectedFrom</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">output</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Disconnect the input from an output</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletOutput</em> output The output to disconnect from.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletInput</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">disconnect</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">output</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">numberOfStreams</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">connectedFrom</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfStreams</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">output</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">connectedFrom</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">connectedFrom</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Check whether the input is connected</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>Boolean</em> True if the output is connected.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletInput</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">isConnected</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">connectedFrom</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletInput</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;Input #&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">index</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>AudioletOutput</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/core/AudioletOutput.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Class representing a single output of an AudioletNode</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletNode</em> node The node which the input belongs to.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> index The index of the input.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">AudioletOutput</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">node</span> <span class="o">=</span> <span class="nx">node</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">index</span> <span class="o">=</span> <span class="nx">index</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">connectedTo</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="c1">// External buffer where data pulled from the graph is stored</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletBuffer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="c1">// Internal buffer for if we are in a feedback loop</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">feedbackBuffer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletBuffer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="c1">// Buffer to shift data into if we are in a feedback loop</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">outputBuffer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletBuffer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">linkedInput</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">suppliesFeedbackLoop</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">timestamp</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Connect the output to an input</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletInput</em> input The input to connect to.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletOutput</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">connect</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">connectedTo</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">input</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Disconnect the output from an input</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletInput</em> input The input to disconnect from.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletOutput</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">disconnect</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">numberOfStreams</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">connectedTo</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfStreams</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">input</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">connectedTo</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">connectedTo</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Check whether the input is connected</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>Boolean</em> True if the output is connected.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletOutput</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">isConnected</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">connectedTo</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Link the output to an input, forcing the output to always contain the
same number of channels as the input.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletInput</em> input The input to link to.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletOutput</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">linkNumberOfChannels</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkedInput</span> <span class="o">=</span> <span class="nx">input</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Unlink the output from its linked input</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletOutput</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">unlinkNumberOfChannels</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkedInput</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Get the number of output channels, taking the value from the input if the
output is linked.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>Number</em> The number of output channels.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletOutput</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getNumberOfChannels</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">linkedInput</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">linkedInput</span><span class="p">.</span><span class="nx">isConnected</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">linkedInput</span><span class="p">.</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Get the output buffer.  This is more complicated than it seems, as in
feedback loops we try to get data from the previous tick, which was often
a different length to the current tick.  In order to get round this we keepi
a fixed length FIFO buffer of the output and limit the size of blocks we
request to the size of the buffer.  This means that we never overflow the
buffer, so output data is always available.  The price we pay for this is
introducing extra latency equal to the length of the FIFO.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> length The number of samples requested.
                                    </li>
                                    <li>
                                        <strong>return</strong> <em>AudioletBuffer</em> The output buffer.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletOutput</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getBuffer</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">buffer</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">suppliesFeedbackLoop</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Buffer not part of a feedback loop, so just return it</span>
        <span class="k">return</span> <span class="nx">buffer</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="c1">// Buffer is part of a feedback loop, so we need to take care</span>
        <span class="c1">// of overflows.</span>
        <span class="c1">// Because feedback loops have to be connected to more than one</span>
        <span class="c1">// node, getBuffer will be called more than once.  To make sure</span>
        <span class="c1">// we only generate the output buffer once, store a timestamp.</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">timestamp</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">timestamp</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Buffer already generated by a previous getBuffer call</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">outputBuffer</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">timestamp</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">timestamp</span><span class="p">;</span>

            <span class="kd">var</span> <span class="nx">feedbackBuffer</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">feedbackBuffer</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">outputBuffer</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">suppliesFeedbackLoop</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">suppliesFeedbackLoop</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">limiter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">blockSizeLimiter</span><span class="p">;</span>
                <span class="nx">feedbackBuffer</span><span class="p">.</span><span class="nx">resize</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getNumberOfChannels</span><span class="p">(),</span>
                                      <span class="nx">limiter</span><span class="p">.</span><span class="nx">maximumBlockSize</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="c1">// Resize feedback buffer to the correct number of channels</span>
            <span class="nx">feedbackBuffer</span><span class="p">.</span><span class="nx">resize</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getNumberOfChannels</span><span class="p">(),</span>
                                  <span class="nx">feedbackBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>

            <span class="c1">// Resize output buffer to the correct size</span>
            <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">resize</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getNumberOfChannels</span><span class="p">(),</span> <span class="nx">length</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

            <span class="c1">// Buffer the output, so nodes on a later timestamp (i.e. nodes</span>
            <span class="c1">// in a feedback loop connected to this output) can pull</span>
            <span class="c1">// any amount up to maximumBlockSize without fear of overflow</span>
            <span class="nx">feedbackBuffer</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">buffer</span><span class="p">);</span>
            <span class="nx">feedbackBuffer</span><span class="p">.</span><span class="nx">shift</span><span class="p">(</span><span class="nx">outputBuffer</span><span class="p">);</span>

            <span class="k">return</span> <span class="nx">outputBuffer</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletOutput</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;Output #&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">index</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>AudioletDestination</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/core/AudioletDestination.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Group containing all of the components for the Audiolet output chain.  The
chain consists of:</p>

<pre><code>Input =&gt; Block Size Limiter =&gt; Scheduler =&gt; UpMixer =&gt; Output
</code></pre>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletGroup
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [sampleRate=44100] The sample rate to run at.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [numberOfChannels=2] The number of output channels.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [bufferSize=8192] A fixed buffer size to use.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">AudioletDestination</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">sampleRate</span><span class="p">,</span> <span class="nx">numberOfChannels</span><span class="p">,</span>
                                   <span class="nx">bufferSize</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletGroup</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">device</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletDevice</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">sampleRate</span><span class="p">,</span>
            <span class="nx">numberOfChannels</span><span class="p">,</span> <span class="nx">bufferSize</span><span class="p">);</span>
    <span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">device</span><span class="p">;</span> <span class="c1">// Shortcut</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">scheduler</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Scheduler</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">);</span>
    <span class="nx">audiolet</span><span class="p">.</span><span class="nx">scheduler</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">scheduler</span><span class="p">;</span> <span class="c1">// Shortcut</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">blockSizeLimiter</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BlockSizeLimiter</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span>
            <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">15</span><span class="p">));</span>
    <span class="nx">audiolet</span><span class="p">.</span><span class="nx">blockSizeLimiter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">blockSizeLimiter</span><span class="p">;</span> <span class="c1">// Shortcut</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">upMixer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">UpMixer</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">blockSizeLimiter</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">blockSizeLimiter</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">scheduler</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">scheduler</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">upMixer</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">upMixer</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">device</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">AudioletDestination</span><span class="p">,</span> <span class="nx">AudioletGroup</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletDestination</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Destination&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>AudioletDevice</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/core/AudioletDevice.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Audio output device.  Uses sink.js to output to a range of APIs.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [sampleRate=44100] The sample rate to run at.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [numberOfChannels=2] The number of output channels.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [bufferSize=8192] A fixed buffer size to use.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">function</span> <span class="nx">AudioletDevice</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">sampleRate</span><span class="p">,</span> <span class="nx">numberOfChannels</span><span class="p">,</span> <span class="nx">bufferSize</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">sink</span> <span class="o">=</span> <span class="nx">Sink</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">tick</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span> <span class="nx">numberOfChannels</span><span class="p">,</span> <span class="nx">bufferSize</span><span class="p">,</span>
                     <span class="nx">sampleRate</span><span class="p">);</span>

    <span class="c1">// Re-read the actual values from the sink.  Sample rate especially is</span>
    <span class="c1">// liable to change depending on what the soundcard allows.</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">sampleRate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">sink</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">sink</span><span class="p">.</span><span class="nx">channelCount</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">bufferSize</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">sink</span><span class="p">.</span><span class="nx">preBufferSize</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">writePosition</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">AudioletDevice</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Overridden tick function. Pulls data from the input and writes it to the
device.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Float32Array</em> buffer Buffer to write data to.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> numberOfChannels Number of channels in the buffer.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletDevice</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">tick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">buffer</span><span class="p">,</span> <span class="nx">numberOfChannels</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">samplesNeeded</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">length</span> <span class="o">/</span> <span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">tick</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">samplesNeeded</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">writePosition</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">interleaved</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">interleaved</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">numberOfSamples</span> <span class="o">=</span> <span class="nx">interleaved</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfSamples</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">buffer</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">interleaved</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">writePosition</span> <span class="o">+=</span> <span class="nx">samplesNeeded</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Make the input buffer available as a member.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers An array containing the input buffer.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers An empty array.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletDevice</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Get the current output position</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>Number</em> Output position in samples.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletDevice</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getPlaybackTime</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">sink</span><span class="p">.</span><span class="nx">getPlayBackTime</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Get the current write position</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>Number</em> Write position in samples.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletDevice</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getWriteTime</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">writePosition</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AudioletDevice</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Audio Output Device&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Scheduler</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/core/Scheduler.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>A sample-accurate scheduler built as an AudioletNode.  The scheduler works
by storing a queue of events, and subdividing the tick call from the
AudioletDevice if an event is scheduled to happen during the tick.  Any
buffers obtained in subdivided ticks are finally merged to produce the
single buffer expected at the output.  All timing and events are handled in
beats, which are converted to sample positions using a master tempo.</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Audio</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [bpm=120] Initial tempo.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Scheduler</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">bpm</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">bpm</span> <span class="o">=</span> <span class="nx">bpm</span> <span class="o">||</span> <span class="mi">120</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">queue</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PriorityQueue</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">time</span> <span class="o">&lt;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">time</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">time</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">beat</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">beatInBar</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">bar</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">seconds</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">beatsPerBar</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">lastBeatTime</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">beatLength</span> <span class="o">=</span> <span class="mi">60</span> <span class="o">/</span> <span class="k">this</span><span class="p">.</span><span class="nx">bpm</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">emptyBuffer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletBuffer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Scheduler</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Set the tempo of the scheduler.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> bpm The tempo in beats per minute.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Scheduler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setTempo</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">bpm</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">bpm</span> <span class="o">=</span> <span class="nx">bpm</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">beatLength</span> <span class="o">=</span> <span class="mi">60</span> <span class="o">/</span> <span class="k">this</span><span class="p">.</span><span class="nx">bpm</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Add an event relative to the current write position</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> beats How many beats in the future to schedule the event.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Function</em> callback A function called when it is time for the event.
                                    </li>
                                    <li>
                                        <strong>return</strong> <em>Object</em> The event object.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Scheduler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">addRelative</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">beats</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">event</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="nx">event</span><span class="p">.</span><span class="nx">callback</span> <span class="o">=</span> <span class="nx">callback</span><span class="p">;</span>
    <span class="nx">event</span><span class="p">.</span><span class="nx">time</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">time</span> <span class="o">+</span> <span class="nx">beats</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">beatLength</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">queue</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">event</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Add an event at an absolute beat position</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> beat The beat at which the event should take place.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Function</em> callback A function called when it is time for the event.
                                    </li>
                                    <li>
                                        <strong>return</strong> <em>Object</em> The event object.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Scheduler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">addAbsolute</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">beat</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">beat</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">beat</span> <span class="o">||</span>
        <span class="nx">beat</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">beat</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">time</span> <span class="o">&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastBeatTime</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Nah</span>
        <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">event</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="nx">event</span><span class="p">.</span><span class="nx">callback</span> <span class="o">=</span> <span class="nx">callback</span><span class="p">;</span>
    <span class="nx">event</span><span class="p">.</span><span class="nx">time</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastBeatTime</span> <span class="o">+</span> <span class="p">(</span><span class="nx">beat</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">beat</span><span class="p">)</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">beatLength</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">queue</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">event</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Schedule patterns to play, and provide the values generated to a callback.
The durationPattern argument can be either a number, giving a constant time
between each event, or a pattern, allowing varying time difference.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Pattern[]</em> patterns An array of patterns to play.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Pattern|Number</em> durationPattern The number of beats between events.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Function</em> callback Function called with the generated pattern values.
                                    </li>
                                    <li>
                                        <strong>return</strong> <em>Object</em> The event object.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Scheduler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">play</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">patterns</span><span class="p">,</span> <span class="nx">durationPattern</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">event</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="nx">event</span><span class="p">.</span><span class="nx">patterns</span> <span class="o">=</span> <span class="nx">patterns</span><span class="p">;</span>
    <span class="nx">event</span><span class="p">.</span><span class="nx">durationPattern</span> <span class="o">=</span> <span class="nx">durationPattern</span><span class="p">;</span>
    <span class="nx">event</span><span class="p">.</span><span class="nx">callback</span> <span class="o">=</span> <span class="nx">callback</span><span class="p">;</span>
    <span class="c1">// TODO: Quantizing start time</span>
    <span class="nx">event</span><span class="p">.</span><span class="nx">time</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">getWriteTime</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">queue</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">event</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Schedule patterns to play starting at an absolute beat position, 
and provide the values generated to a callback.
The durationPattern argument can be either a number, giving a constant time
between each event, or a pattern, allowing varying time difference.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> beat The beat at which the event should take place.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Pattern[]</em> patterns An array of patterns to play.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Pattern|Number</em> durationPattern The number of beats between events.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Function</em> callback Function called with the generated pattern values.
                                    </li>
                                    <li>
                                        <strong>return</strong> <em>Object</em> The event object.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Scheduler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">playAbsolute</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">beat</span><span class="p">,</span> <span class="nx">patterns</span><span class="p">,</span> <span class="nx">durationPattern</span><span class="p">,</span>
                                            <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">beat</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">beat</span> <span class="o">||</span>
        <span class="nx">beat</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">beat</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">time</span> <span class="o">&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastBeatTime</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Nah</span>
        <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">event</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="nx">event</span><span class="p">.</span><span class="nx">patterns</span> <span class="o">=</span> <span class="nx">patterns</span><span class="p">;</span>
    <span class="nx">event</span><span class="p">.</span><span class="nx">durationPattern</span> <span class="o">=</span> <span class="nx">durationPattern</span><span class="p">;</span>
    <span class="nx">event</span><span class="p">.</span><span class="nx">callback</span> <span class="o">=</span> <span class="nx">callback</span><span class="p">;</span>
    <span class="nx">event</span><span class="p">.</span><span class="nx">time</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastBeatTime</span> <span class="o">+</span> <span class="p">(</span><span class="nx">beat</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">beat</span><span class="p">)</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">beatLength</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">queue</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">event</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Remove a scheduled event from the scheduler</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Object</em> event The event to remove.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Scheduler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">remove</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">idx</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">queue</span><span class="p">.</span><span class="nx">heap</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">idx</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">queue</span><span class="p">.</span><span class="nx">heap</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">idx</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
        <span class="c1">// Recreate queue with event removed</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">queue</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PriorityQueue</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">queue</span><span class="p">.</span><span class="nx">heap</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">time</span> <span class="o">&lt;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">time</span><span class="p">);</span>
        <span class="p">});</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Alias for remove, so for simple events we have add/remove, and for patterns
we have play/stop.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Object</em> event The event to remove.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Scheduler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">stop</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Overridden tick method.  This is where the scheduler magic of splitting down
blocks allows sample-accurate changes to happen, and also where we process
the events themselves.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> length The number of samples to process.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> timestamp A timestamp for the block of samples.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Scheduler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">tick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">length</span><span class="p">,</span> <span class="nx">timestamp</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// The time at the beginning of the block</span>
    <span class="kd">var</span> <span class="nx">startTime</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">getWriteTime</span><span class="p">();</span>

    <span class="c1">// Update the clock so it is correct for the first samples</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">updateClock</span><span class="p">(</span><span class="nx">startTime</span><span class="p">);</span>

    <span class="c1">// Don&#39;t create the output buffer yet - it needs to be created after</span>
    <span class="c1">// the first input buffer so we can work out how many channels it needs</span>
    <span class="kd">var</span> <span class="nx">outputBuffers</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

    <span class="c1">// Generate the block of samples and carry out events, generating a</span>
    <span class="c1">// new sub-block each time an event is carried out</span>
    <span class="kd">var</span> <span class="nx">lastEventTime</span> <span class="o">=</span> <span class="nx">startTime</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">queue</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">()</span> <span class="o">&amp;&amp;</span>
           <span class="k">this</span><span class="p">.</span><span class="nx">queue</span><span class="p">.</span><span class="nx">peek</span><span class="p">().</span><span class="nx">time</span> <span class="o">&lt;=</span> <span class="nx">startTime</span> <span class="o">+</span> <span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">event</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">queue</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
        <span class="c1">// Event can&#39;t take place before the previous event</span>
        <span class="kd">var</span> <span class="nx">eventTime</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">time</span><span class="p">,</span> <span class="nx">lastEventTime</span><span class="p">));</span>

        <span class="c1">// Generate samples to take us to the event</span>
        <span class="kd">var</span> <span class="nx">timeToEvent</span> <span class="o">=</span> <span class="nx">eventTime</span> <span class="o">-</span> <span class="nx">lastEventTime</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">timeToEvent</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">offset</span> <span class="o">=</span> <span class="nx">lastEventTime</span> <span class="o">-</span> <span class="nx">startTime</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">tickParents</span><span class="p">(</span><span class="nx">timeToEvent</span><span class="p">,</span>
                             <span class="nx">timestamp</span> <span class="o">+</span> <span class="nx">offset</span><span class="p">);</span>

            <span class="c1">// Get the summed input</span>
            <span class="kd">var</span> <span class="nx">inputBuffers</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">createInputBuffers</span><span class="p">(</span><span class="nx">timeToEvent</span><span class="p">);</span>

            <span class="c1">// Create the output buffer</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">outputBuffers</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">createOutputBuffers</span><span class="p">(</span><span class="nx">length</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="c1">// Copy it to the right part of the output</span>
            <span class="c1">// Use the generate function so it looks and quacks like an</span>
            <span class="c1">// AudioletNode</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">generate</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">,</span> <span class="nx">offset</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">// Update the clock so it is correct for the current event</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">updateClock</span><span class="p">(</span><span class="nx">eventTime</span><span class="p">);</span>


        <span class="c1">// Set this before processEvent, as that can change the event time</span>
        <span class="nx">lastEventTime</span> <span class="o">=</span> <span class="nx">eventTime</span><span class="p">;</span>
        <span class="c1">// Carry out the event</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">processEvent</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// Generate enough samples to complete the block</span>
    <span class="kd">var</span> <span class="nx">remainingTime</span> <span class="o">=</span> <span class="nx">startTime</span> <span class="o">+</span> <span class="nx">length</span> <span class="o">-</span> <span class="nx">lastEventTime</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">remainingTime</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">tickParents</span><span class="p">(</span><span class="nx">remainingTime</span><span class="p">,</span>
                         <span class="nx">timestamp</span> <span class="o">+</span> <span class="nx">lastEventTime</span> <span class="o">-</span> <span class="nx">startTime</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">inputBuffers</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">createInputBuffers</span><span class="p">(</span><span class="nx">remainingTime</span><span class="p">);</span>

        <span class="c1">// Make sure we have an output buffer</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">outputBuffers</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">createOutputBuffers</span><span class="p">(</span><span class="nx">length</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="kd">var</span> <span class="nx">offset</span> <span class="o">=</span> <span class="nx">lastEventTime</span> <span class="o">-</span> <span class="nx">startTime</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">generate</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">,</span> <span class="nx">offset</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Update the various representations of time within the scheduler.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> time The current write position in samples.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Scheduler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">updateClock</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">time</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">time</span> <span class="o">=</span> <span class="nx">time</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">seconds</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">time</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">time</span> <span class="o">&gt;=</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastBeatTime</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">beatLength</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">beat</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">beatInBar</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">beatInBar</span> <span class="o">==</span> <span class="k">this</span><span class="p">.</span><span class="nx">beatsPerBar</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">bar</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">beatInBar</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">lastBeatTime</span> <span class="o">+=</span> <span class="k">this</span><span class="p">.</span><span class="nx">beatLength</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a single event, grabbing any necessary values, calling the event's
callback, and rescheduling it if necessary.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Object</em> event The event to process.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Scheduler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">processEvent</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">durationPattern</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">durationPattern</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">durationPattern</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Pattern event</span>
        <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="kd">var</span> <span class="nx">patterns</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">patterns</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">numberOfPatterns</span> <span class="o">=</span> <span class="nx">patterns</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfPatterns</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">pattern</span> <span class="o">=</span> <span class="nx">patterns</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">pattern</span><span class="p">.</span><span class="nx">next</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">args</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="c1">// Null value for an argument, so don&#39;t process the</span>
                <span class="c1">// callback or add any further events</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="nx">event</span><span class="p">.</span><span class="nx">callback</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>

        <span class="kd">var</span> <span class="nx">duration</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">durationPattern</span> <span class="k">instanceof</span> <span class="nx">Pattern</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">duration</span> <span class="o">=</span> <span class="nx">durationPattern</span><span class="p">.</span><span class="nx">next</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="nx">duration</span> <span class="o">=</span> <span class="nx">durationPattern</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">duration</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Beats -&gt; time</span>
            <span class="nx">event</span><span class="p">.</span><span class="nx">time</span> <span class="o">+=</span> <span class="nx">duration</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">beatLength</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">queue</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="c1">// Regular event</span>
        <span class="nx">event</span><span class="p">.</span><span class="nx">callback</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Overridden function reading from the input buffers, and putting new values
into sections of the output buffers.  Also handles buffers which are flagged
as being empty, converting them into actual zeroed buffers.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> offset Sample offset for writing to the output buffers.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Scheduler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">,</span> <span class="nx">offset</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">inputChannel</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Substitute the supposedly empty buffer with an actually</span>
            <span class="c1">// empty buffer.  This means that we don&#39;t have to  zero</span>
            <span class="c1">// buffers in other nodes</span>
            <span class="kd">var</span> <span class="nx">emptyBuffer</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">emptyBuffer</span><span class="p">;</span>
            <span class="nx">emptyBuffer</span><span class="p">.</span><span class="nx">resize</span><span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">,</span>
                               <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
            <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">emptyBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="nx">outputChannel</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">inputChannel</span><span class="p">,</span> <span class="nx">offset</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Scheduler</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Scheduler&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>PassThroughNode</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/core/PassThroughNode.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>A specialized type of AudioletNode where values from the inputs are passed
straight to the corresponding outputs in the most efficient way possible.
PassThroughNodes are used in AudioletGroups to provide the inputs and
outputs, and can also be used in analysis nodes where no modifications to
the incoming audio are made.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> numberOfInputs The number of inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> numberOfOutputs The number of outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">PassThroughNode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">numberOfInputs</span><span class="p">,</span> <span class="nx">numberOfOutputs</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="nx">numberOfInputs</span><span class="p">,</span> <span class="nx">numberOfOutputs</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">PassThroughNode</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Create output buffers of the correct length, copying any input buffers to
the corresponding outputs.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> length The number of samples for the resulting buffers.
                                    </li>
                                    <li>
                                        <strong>return</strong> <em>AudioletNode[]</em> The output buffers.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">PassThroughNode</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">createOutputBuffers</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">outputBuffers</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">numberOfOutputs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">numberOfOutputs</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">numberOfInputs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">numberOfInputs</span><span class="p">;</span>
    <span class="c1">// Copy the inputs buffers straight to the output buffers</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfOutputs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">output</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfInputs</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Copy the input buffer straight to the output buffers</span>
            <span class="kd">var</span> <span class="nx">input</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="nx">output</span><span class="p">.</span><span class="nx">buffer</span> <span class="o">=</span> <span class="nx">input</span><span class="p">.</span><span class="nx">buffer</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="nx">output</span><span class="p">.</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">resize</span><span class="p">(</span><span class="nx">output</span><span class="p">.</span><span class="nx">getNumberOfChannels</span><span class="p">(),</span> <span class="nx">length</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">outputBuffers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">output</span><span class="p">.</span><span class="nx">buffer</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">outputBuffers</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">PassThroughNode</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Pass Through Node&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>ParameterNode</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/core/ParameterNode.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>A type of AudioletNode designed to allow AudioletGroups to exactly replicate
the behaviour of AudioletParameters.  By linking one of the group's inputs
to the ParameterNode's input, and calling <code>this.parameterName =
parameterNode</code> in the group's constructor, <code>this.parameterName</code> will behave
as if it were an AudioletParameter contained within an AudioletNode.</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Parameter input</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Parameter value</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>parameter The contained parameter.  Linked to input 0.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> value The initial static value of the parameter.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">ParameterNode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">parameter</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">value</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">ParameterNode</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">ParameterNode</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">parameterParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">parameter</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">parameter</span><span class="p">,</span> <span class="nx">parameterChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">parameterParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">parameter</span> <span class="o">=</span> <span class="nx">parameterParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">parameterChannel</span> <span class="o">=</span> <span class="nx">parameterParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>


    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">parameterChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">parameter</span> <span class="o">=</span> <span class="nx">parameterChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">parameter</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">ParameterNode</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Parameter Node&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>BlockSizeLimiter</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/core/BlockSizeLimiter.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Node to limit the size of sample blocks which are processed.  Any larger
blocks requested are split into smaller blocks and recombined at the end
of a tick call.</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Audio</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> maximumBlockSize The largest allowed block size.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">BlockSizeLimiter</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">maximumBlockSize</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">maximumBlockSize</span> <span class="o">=</span> <span class="nx">maximumBlockSize</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">BlockSizeLimiter</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Overridden tick method.  Splits any calls with length larger than the
maximum block size into chunks smaller than the maximum, combining the
chunks in the output buffers.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> length The number of samples to process.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> timestamp A timestamp for the block of samples.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BlockSizeLimiter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">tick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">length</span><span class="p">,</span> <span class="nx">timestamp</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">maximumBlockSize</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">maximumBlockSize</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="nx">maximumBlockSize</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Enough samples from the last tick and buffered, so just tick</span>
        <span class="c1">// and recalculate any overflow</span>
        <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">tick</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">length</span><span class="p">,</span> <span class="nx">timestamp</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="c1">// Not enough samples available, so we will have to do it in blocks</span>
        <span class="c1">// of size maximumBlockSize</span>
        <span class="kd">var</span> <span class="nx">samplesGenerated</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">outputBuffers</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">samplesGenerated</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">samplesNeeded</span><span class="p">;</span>
            <span class="c1">// If length does not split exactly into the block size,</span>
            <span class="c1">// then do the small block size first, so at the end we still</span>
            <span class="c1">// have a lastTickSize equal to maximumBlockSize</span>
            <span class="kd">var</span> <span class="nx">smallBlockSize</span> <span class="o">=</span> <span class="nx">length</span> <span class="o">%</span> <span class="nx">maximumBlockSize</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">samplesGenerated</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">smallBlockSize</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">samplesNeeded</span> <span class="o">=</span> <span class="nx">smallBlockSize</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">samplesNeeded</span> <span class="o">=</span> <span class="nx">maximumBlockSize</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">this</span><span class="p">.</span><span class="nx">tickParents</span><span class="p">(</span><span class="nx">samplesNeeded</span><span class="p">,</span> <span class="nx">timestamp</span> <span class="o">+</span> <span class="nx">samplesGenerated</span><span class="p">);</span>

            <span class="kd">var</span> <span class="nx">inputBuffers</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">createInputBuffers</span><span class="p">(</span><span class="nx">samplesNeeded</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">outputBuffers</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">createOutputBuffers</span><span class="p">(</span><span class="nx">length</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">generate</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">,</span> <span class="nx">samplesGenerated</span><span class="p">);</span>

            <span class="nx">samplesGenerated</span> <span class="o">+=</span> <span class="nx">samplesNeeded</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Overridden function reading from the input buffers, and putting new values
into sections of the output buffers.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> offset Sample offset for writing to the output buffers.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BlockSizeLimiter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">,</span>
                                               <span class="nx">offset</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">offset</span> <span class="o">=</span> <span class="nx">offset</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">setSection</span><span class="p">(</span><span class="nx">inputBuffer</span><span class="p">,</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
                            <span class="mi">0</span><span class="p">,</span> <span class="nx">offset</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BlockSizeLimiter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Block Size Limiter&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>PriorityQueue</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/core/PriorityQueue.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Priority Queue based on python heapq module
http://svn.python.org/view/python/branches/release27-maint/Lib/heapq.py</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Object[]</em> [array] Initial array of values to store.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Function</em> [compare] Compare function.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">PriorityQueue</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="nx">compare</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">compare</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">compare</span> <span class="o">=</span> <span class="nx">compare</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">array</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">heap</span> <span class="o">=</span> <span class="nx">array</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">heap</span><span class="p">.</span><span class="nx">length</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">siftUp</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">heap</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Add an item to the queue</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Object</em> item The item to add.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">PriorityQueue</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">push</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">heap</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">siftDown</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">heap</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Remove and return the top item from the queue.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>Object</em> The top item.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">PriorityQueue</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">pop</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">lastElement</span><span class="p">,</span> <span class="nx">returnItem</span><span class="p">;</span>
    <span class="nx">lastElement</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">heap</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">heap</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">returnItem</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">heap</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">heap</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">lastElement</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">siftUp</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">returnItem</span> <span class="o">=</span> <span class="nx">lastElement</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">returnItem</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Return the top item from the queue, without removing it.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>Object</em> The top item.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">PriorityQueue</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">peek</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">heap</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Check whether the queue is empty.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>Boolean</em> True if the queue is empty.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">PriorityQueue</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">heap</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Sift item down the queue.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> startPosition Queue start position.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> position Item position.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">PriorityQueue</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">siftDown</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">startPosition</span><span class="p">,</span> <span class="nx">position</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">newItem</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">heap</span><span class="p">[</span><span class="nx">position</span><span class="p">];</span>
    <span class="k">while</span> <span class="p">(</span><span class="nx">position</span> <span class="o">&gt;</span> <span class="nx">startPosition</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">parentPosition</span> <span class="o">=</span> <span class="p">(</span><span class="nx">position</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">parent</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">heap</span><span class="p">[</span><span class="nx">parentPosition</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">compare</span><span class="p">(</span><span class="nx">newItem</span><span class="p">,</span> <span class="nx">parent</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">heap</span><span class="p">[</span><span class="nx">position</span><span class="p">]</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">;</span>
            <span class="nx">position</span> <span class="o">=</span> <span class="nx">parentPosition</span><span class="p">;</span>
            <span class="k">continue</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">heap</span><span class="p">[</span><span class="nx">position</span><span class="p">]</span> <span class="o">=</span> <span class="nx">newItem</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Sift item up the queue.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> position Item position.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">PriorityQueue</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">siftUp</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">position</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">endPosition</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">heap</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">startPosition</span> <span class="o">=</span> <span class="nx">position</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">newItem</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">heap</span><span class="p">[</span><span class="nx">position</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">childPosition</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nx">position</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="nx">childPosition</span> <span class="o">&lt;</span> <span class="nx">endPosition</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">rightPosition</span> <span class="o">=</span> <span class="nx">childPosition</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">rightPosition</span> <span class="o">&lt;</span> <span class="nx">endPosition</span> <span class="o">&amp;&amp;</span>
            <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">compare</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">heap</span><span class="p">[</span><span class="nx">childPosition</span><span class="p">],</span>
                          <span class="k">this</span><span class="p">.</span><span class="nx">heap</span><span class="p">[</span><span class="nx">rightPosition</span><span class="p">]))</span> <span class="p">{</span>
            <span class="nx">childPosition</span> <span class="o">=</span> <span class="nx">rightPosition</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">heap</span><span class="p">[</span><span class="nx">position</span><span class="p">]</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">heap</span><span class="p">[</span><span class="nx">childPosition</span><span class="p">];</span>
        <span class="nx">position</span> <span class="o">=</span> <span class="nx">childPosition</span><span class="p">;</span>
        <span class="nx">childPosition</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nx">position</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">heap</span><span class="p">[</span><span class="nx">position</span><span class="p">]</span> <span class="o">=</span> <span class="nx">newItem</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">siftDown</span><span class="p">(</span><span class="nx">startPosition</span><span class="p">,</span> <span class="nx">position</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Default compare function.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> a First item.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> b Second item.
                                    </li>
                                    <li>
                                        <strong>return</strong> <em>Boolean</em> True if a < b.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">PriorityQueue</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">compare</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">a</span> <span class="o">&lt;</span> <span class="nx">b</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Extend</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/core/Extend.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>A method for extending a javascript pseudo-class
Taken from
http://peter.michaux.ca/articles/class-based-inheritance-in-javascript</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Object</em> subclass The class to extend.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Object</em> superclass The class to be extended.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">function</span> <span class="nx">extend</span><span class="p">(</span><span class="nx">subclass</span><span class="p">,</span> <span class="nx">superclass</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">function</span> <span class="nx">Dummy</span><span class="p">()</span> <span class="p">{}</span>
    <span class="nx">Dummy</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nx">superclass</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>
    <span class="nx">subclass</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Dummy</span><span class="p">();</span>
    <span class="nx">subclass</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">subclass</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>TypedArrayShim</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/core/TypedArrayShim.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Bidirectional shim for the renaming of slice to subarray.  Provides
backwards compatibility with old browser releases</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Int8Array</span><span class="p">,</span> <span class="nx">Uint8Array</span><span class="p">,</span> <span class="nx">Int16Array</span><span class="p">,</span> <span class="nx">Uint16Array</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">Int32Array</span><span class="p">,</span> <span class="nx">Uint32Array</span><span class="p">,</span> <span class="nx">Float32Array</span><span class="p">,</span> <span class="nx">Float64Array</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">types</span> <span class="o">=</span> <span class="p">[</span><span class="nx">Int8Array</span><span class="p">,</span> <span class="nx">Uint8Array</span><span class="p">,</span> <span class="nx">Int16Array</span><span class="p">,</span> <span class="nx">Uint16Array</span><span class="p">,</span>
             <span class="nx">Int32Array</span><span class="p">,</span> <span class="nx">Uint32Array</span><span class="p">,</span> <span class="nx">Float32Array</span><span class="p">,</span> <span class="nx">Float64Array</span><span class="p">];</span>
<span class="kd">var</span> <span class="nx">original</span><span class="p">,</span> <span class="nx">shim</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">types</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">types</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">types</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">original</span> <span class="o">=</span> <span class="s1">&#39;subarray&#39;</span><span class="p">;</span>
            <span class="nx">shim</span> <span class="o">=</span> <span class="s1">&#39;slice&#39;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">types</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">subarray</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">original</span> <span class="o">=</span> <span class="s1">&#39;slice&#39;</span><span class="p">;</span>
            <span class="nx">shim</span> <span class="o">=</span> <span class="s1">&#39;subarray&#39;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">types</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">prototype</span><span class="p">,</span> <span class="nx">shim</span><span class="p">,</span> <span class="p">{</span>
            <span class="nx">value</span><span class="o">:</span> <span class="nx">types</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">prototype</span><span class="p">[</span><span class="nx">original</span><span class="p">],</span>
            <span class="nx">enumerable</span><span class="o">:</span> <span class="kc">false</span>
        <span class="p">});</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                
            </div>
            <div class="section">
                <div class="header block">
                    <div class="left">
                        <div>
                            <h2>DSP</h2>
                        </div>
                    </div>
                    <div class="right">
                        <div><p>Audio generation and processing nodes</p>
</div>
                    </div>
                    <div class="clear"></div>
                </div>

                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>TableLookupOscillator</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/TableLookupOscillator.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Oscillator which reads waveform values from a look-up table</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Frequency</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Waveform</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>frequency The oscillator frequency.  Linked to input 0.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [frequency=440] The initial frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">TableLookupOscillator</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">table</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">table</span> <span class="o">=</span> <span class="nx">table</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">frequency</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">frequency</span> <span class="o">||</span> <span class="mi">440</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">phase</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">TableLookupOscillator</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">TableLookupOscillator</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span>
                                                    <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">buffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">channel</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Make processing variables local</span>
    <span class="kd">var</span> <span class="nx">sampleRate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">table</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">table</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">tableSize</span> <span class="o">=</span> <span class="nx">table</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">phase</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">phase</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">frequencyParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">frequency</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">frequency</span><span class="p">,</span> <span class="nx">frequencyChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">frequencyParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">frequency</span> <span class="o">=</span> <span class="nx">frequencyParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">frequencyChannel</span> <span class="o">=</span> <span class="nx">frequencyParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="c1">// Processing loop</span>
    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">frequencyChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">frequency</span> <span class="o">=</span> <span class="nx">frequencyChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">step</span> <span class="o">=</span> <span class="nx">frequency</span> <span class="o">*</span> <span class="nx">tableSize</span> <span class="o">/</span> <span class="nx">sampleRate</span><span class="p">;</span>
        <span class="nx">phase</span> <span class="o">+=</span> <span class="nx">step</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">phase</span> <span class="o">&gt;=</span> <span class="nx">tableSize</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">phase</span> <span class="o">%=</span> <span class="nx">tableSize</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">channel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">table</span><span class="p">[</span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">phase</span><span class="p">)];</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">phase</span> <span class="o">=</span> <span class="nx">phase</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">TableLookupOscillator</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Table Lookup Oscillator&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Sine</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/Sine.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Sine wave oscillator using a lookup table</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Frequency</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Sine wave</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>frequency The frequency of the oscillator.  Linked to input 0.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> TableLookupOscillator
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [frequency=440] Initial frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Sine</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">TableLookupOscillator</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="nx">Sine</span><span class="p">.</span><span class="nx">TABLE</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Sine</span><span class="p">,</span> <span class="nx">TableLookupOscillator</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Sine</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Sine&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Sine table</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Sine</span><span class="p">.</span><span class="nx">TABLE</span> <span class="o">=</span> <span class="p">[];</span>
<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">8192</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Sine</span><span class="p">.</span><span class="nx">TABLE</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">/</span> <span class="mi">8192</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Triangle</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/Triangle.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Triangle wave oscillator using a lookup table</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Frequency</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Triangle wave</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>frequency The frequency of the oscillator.  Linked to input 0.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> TableLookupOscillator
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [frequency=440] Initial frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Triangle</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">TableLookupOscillator</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="nx">Triangle</span><span class="p">.</span><span class="nx">TABLE</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Triangle</span><span class="p">,</span> <span class="nx">TableLookupOscillator</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Triangle</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Triangle&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Triangle table</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Triangle</span><span class="p">.</span><span class="nx">TABLE</span> <span class="o">=</span> <span class="p">[];</span>
<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">8192</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Smelly, but looks right...</span>
    <span class="nx">Triangle</span><span class="p">.</span><span class="nx">TABLE</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(((((</span><span class="nx">i</span> <span class="o">-</span> <span class="mi">2048</span><span class="p">)</span> <span class="o">/</span> <span class="mi">8192</span><span class="p">)</span> <span class="o">%</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">1</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Saw</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/Saw.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Saw wave oscillator using a lookup table</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Frequency</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Saw wave</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>frequency The frequency of the oscillator.  Linked to input 0.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> TableLookupOscillator
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [frequency=440] Initial frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Saw</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">TableLookupOscillator</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="nx">Saw</span><span class="p">.</span><span class="nx">TABLE</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Saw</span><span class="p">,</span> <span class="nx">TableLookupOscillator</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Saw</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Saw&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Saw table</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Saw</span><span class="p">.</span><span class="nx">TABLE</span> <span class="o">=</span> <span class="p">[];</span>
<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">8192</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Saw</span><span class="p">.</span><span class="nx">TABLE</span><span class="p">.</span><span class="nx">push</span><span class="p">(((((</span><span class="nx">i</span> <span class="o">-</span> <span class="mi">4096</span><span class="p">)</span> <span class="o">/</span> <span class="mi">8192</span><span class="p">)</span> <span class="o">%</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">1</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Square</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/Square.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Square wave oscillator using a lookup table</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Frequency</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Square wave</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>frequency The frequency of the oscillator.  Linked to input 0.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> TableLookupOscillator
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [frequency=440] Initial frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Square</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">TableLookupOscillator</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="nx">Square</span><span class="p">.</span><span class="nx">TABLE</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Square</span><span class="p">,</span> <span class="nx">TableLookupOscillator</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Square</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Square&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Square wave table</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Square</span><span class="p">.</span><span class="nx">TABLE</span> <span class="o">=</span> <span class="p">[];</span>
<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">8192</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Square</span><span class="p">.</span><span class="nx">TABLE</span><span class="p">.</span><span class="nx">push</span><span class="p">(((</span><span class="nx">i</span> <span class="o">-</span> <span class="mi">4096</span><span class="p">)</span> <span class="o">/</span> <span class="mi">8192</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Pulse</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/Pulse.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Pulse wave oscillator.</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Frequency</li>
<li>Pulse width</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Waveform</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>frequency The oscillator frequency.  Linked to input 0.</li>
<li>pulseWidth The pulse width.  Linked to input 1.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [frequency=440] The initial frequency.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [pulseWidth=0.5] The initial pulse width.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Pulse</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">,</span> <span class="nx">pulseWidth</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">frequency</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">frequency</span> <span class="o">||</span> <span class="mi">440</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">pulseWidth</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">pulseWidth</span> <span class="o">||</span> <span class="mf">0.5</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">phase</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Pulse</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Pulse</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">buffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">channel</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Make processing variables local</span>
    <span class="kd">var</span> <span class="nx">sampleRate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">phase</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">phase</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">frequencyParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">frequency</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">frequency</span><span class="p">,</span> <span class="nx">frequencyChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">frequencyParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">frequency</span> <span class="o">=</span> <span class="nx">frequencyParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">frequencyChannel</span> <span class="o">=</span> <span class="nx">frequencyParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">pulseWidthParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">pulseWidth</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">pulseWidth</span><span class="p">,</span> <span class="nx">pulseWidthChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">pulseWidthParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">pulseWidth</span> <span class="o">=</span> <span class="nx">pulseWidthParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">pulseWidthChannel</span> <span class="o">=</span> <span class="nx">pulseWidthParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="c1">// Processing loop</span>
    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">frequencyChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">frequency</span> <span class="o">=</span> <span class="nx">frequencyChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">pulseWidthChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">pulseWidth</span> <span class="o">=</span> <span class="nx">pulseWidthChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>

        <span class="nx">phase</span> <span class="o">+=</span> <span class="nx">frequency</span> <span class="o">/</span> <span class="nx">sampleRate</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">phase</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">phase</span> <span class="o">%=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">channel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nx">phase</span> <span class="o">&lt;</span> <span class="nx">pulseWidth</span><span class="p">)</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">phase</span> <span class="o">=</span> <span class="nx">phase</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Pulse</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Pulse&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>WhiteNoise</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/WhiteNoise.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>A white noise source</p>

<p><strong>Outputs</strong></p>

<ul>
<li>White noise</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">WhiteNoise</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">WhiteNoise</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">WhiteNoise</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">buffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">channel</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Processing loop</span>
    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">channel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">WhiteNoise</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;White Noise&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Envelope</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/Envelope.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>A generic envelope consisting of linear transitions of varying duration
between a series of values.</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Gate</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Envelope</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>gate Gate controlling the envelope.  Values should be 0 (off) or 1 (on).
Linked to input 0.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [gate=1] Initial gate value.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number[]</em> levels An array (of length n) of values to move between.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number[]</em> times An array of n-1 durations - one for each transition.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [releaseStage] Sustain at this stage until the the gate is 0.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Function</em> [onComplete] Function called as the envelope finishes.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Envelope</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">gate</span><span class="p">,</span> <span class="nx">levels</span><span class="p">,</span> <span class="nx">times</span><span class="p">,</span> <span class="nx">releaseStage</span><span class="p">,</span>
                        <span class="nx">onComplete</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">gate</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">gate</span> <span class="o">||</span> <span class="mi">1</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">levels</span> <span class="o">=</span> <span class="nx">levels</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">times</span> <span class="o">=</span> <span class="nx">times</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">releaseStage</span> <span class="o">=</span> <span class="nx">releaseStage</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">onComplete</span> <span class="o">=</span> <span class="nx">onComplete</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">stage</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">time</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">changeTime</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">level</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">delta</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">gateOn</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Envelope</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Envelope</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">buffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">channel</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">gateParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">gate</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">gate</span><span class="p">,</span> <span class="nx">gateChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">gateParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">gate</span> <span class="o">=</span> <span class="nx">gateParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">gateChannel</span> <span class="o">=</span> <span class="nx">gateParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">releaseStage</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">releaseStage</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">stage</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">stage</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">time</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">time</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">changeTime</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">changeTime</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">level</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">level</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">delta</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">delta</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">gateOn</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">gateOn</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">stageChanged</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">gateChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">gate</span> <span class="o">=</span> <span class="nx">gateChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">gate</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">gateOn</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Key pressed</span>
            <span class="nx">gateOn</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="nx">stage</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="nx">time</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="nx">stageChanged</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">gateOn</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">gate</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Key released</span>
            <span class="nx">gateOn</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">releaseStage</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// Jump to the release stage</span>
                <span class="nx">stage</span> <span class="o">=</span> <span class="nx">releaseStage</span><span class="p">;</span>
                <span class="nx">stageChanged</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">changeTime</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// We are not sustaining, and we are playing, so increase the</span>
            <span class="c1">// time</span>
            <span class="nx">time</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">time</span> <span class="o">&gt;=</span> <span class="nx">changeTime</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// Need to go to the next stage</span>
                <span class="nx">stage</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">stage</span> <span class="o">!=</span> <span class="nx">releaseStage</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">stageChanged</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span>
                    <span class="c1">// If we reach the release stage then sustain the value</span>
                    <span class="c1">// until the gate is released rather than moving on</span>
                    <span class="c1">// to the next level.</span>
                    <span class="nx">changeTime</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
                    <span class="nx">delta</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">stageChanged</span><span class="p">)</span> <span class="p">{</span>
<span class="c1">//            level = this.levels[stage];</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">stage</span> <span class="o">!=</span> <span class="k">this</span><span class="p">.</span><span class="nx">times</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// Actually update the variables</span>
                <span class="nx">delta</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">calculateDelta</span><span class="p">(</span><span class="nx">stage</span><span class="p">,</span> <span class="nx">level</span><span class="p">);</span>
                <span class="nx">changeTime</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">calculateChangeTime</span><span class="p">(</span><span class="nx">stage</span><span class="p">,</span> <span class="nx">time</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="c1">// Made it to the end, so finish up</span>
                <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">onComplete</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">onComplete</span><span class="p">();</span>
                <span class="p">}</span>
                <span class="nx">stage</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
                <span class="nx">time</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
                <span class="nx">changeTime</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

                <span class="nx">delta</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">stageChanged</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">level</span> <span class="o">+=</span> <span class="nx">delta</span><span class="p">;</span>
        <span class="nx">channel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">level</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">stage</span> <span class="o">=</span> <span class="nx">stage</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">time</span> <span class="o">=</span> <span class="nx">time</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">changeTime</span> <span class="o">=</span> <span class="nx">changeTime</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">level</span> <span class="o">=</span> <span class="nx">level</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">delta</span> <span class="o">=</span> <span class="nx">delta</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">gateOn</span> <span class="o">=</span> <span class="nx">gateOn</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Calculate the change in level needed each sample for a section</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> stage The index of the current stage.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> level The current level.
                                    </li>
                                    <li>
                                        <strong>return</strong> <em>Number</em> The change in level.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Envelope</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">calculateDelta</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">stage</span><span class="p">,</span> <span class="nx">level</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">delta</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">levels</span><span class="p">[</span><span class="nx">stage</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="nx">level</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">stageTime</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">times</span><span class="p">[</span><span class="nx">stage</span><span class="p">]</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">delta</span> <span class="o">/</span> <span class="nx">stageTime</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Calculate the time in samples at which the next stage starts</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> stage The index of the current stage.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> time The current time.
                                    </li>
                                    <li>
                                        <strong>return</strong> <em>Number</em> The change time.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Envelope</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">calculateChangeTime</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">stage</span><span class="p">,</span> <span class="nx">time</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">stageTime</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">times</span><span class="p">[</span><span class="nx">stage</span><span class="p">]</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">time</span> <span class="o">+</span> <span class="nx">stageTime</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Envelope</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Envelope&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>ADSREnvelope</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/ADSREnvelope.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Linear attack-decay-sustain-release envelope</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Gate</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Envelope</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>gate The gate turning the envelope on and off.  Value changes from 0 -> 1
trigger the envelope.  Value changes from 1 -> 0 make the envelope move to
its release stage.  Linked to input 0.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> Envelope
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> gate The initial gate value.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> attack The attack time in seconds.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> decay The decay time in seconds.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> sustain The sustain level (between 0 and 1).
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> release The release time in seconds.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Function</em> onComplete A function called after the release stage.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">ADSREnvelope</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">gate</span><span class="p">,</span> <span class="nx">attack</span><span class="p">,</span> <span class="nx">decay</span><span class="p">,</span> <span class="nx">sustain</span><span class="p">,</span> <span class="nx">release</span><span class="p">,</span>
                            <span class="nx">onComplete</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">levels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">sustain</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">times</span> <span class="o">=</span> <span class="p">[</span><span class="nx">attack</span><span class="p">,</span> <span class="nx">decay</span><span class="p">,</span> <span class="nx">release</span><span class="p">];</span>
    <span class="nx">Envelope</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="nx">gate</span><span class="p">,</span> <span class="nx">levels</span><span class="p">,</span> <span class="nx">times</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">onComplete</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">ADSREnvelope</span><span class="p">,</span> <span class="nx">Envelope</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">ADSREnvelope</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;ADSR Envelope&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>PercussiveEnvelope</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/PercussiveEnvelope.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Simple attack-release envelope</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Gate</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Envelope</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>gate The gate controlling the envelope.  Value changes from 0 -> 1
trigger the envelope.  Linked to input 0.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> Envelope
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> gate The initial gate value.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> attack The attack time in seconds.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> release The release time in seconds.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Function</em> [onComplete] A function called after the release stage.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">PercussiveEnvelope</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">gate</span><span class="p">,</span> <span class="nx">attack</span><span class="p">,</span> <span class="nx">release</span><span class="p">,</span>
                                  <span class="nx">onComplete</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">levels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">times</span> <span class="o">=</span> <span class="p">[</span><span class="nx">attack</span><span class="p">,</span> <span class="nx">release</span><span class="p">];</span>
    <span class="nx">Envelope</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="nx">gate</span><span class="p">,</span> <span class="nx">levels</span><span class="p">,</span> <span class="nx">times</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">onComplete</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">PercussiveEnvelope</span><span class="p">,</span> <span class="nx">Envelope</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">PercussiveEnvelope</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Percussive Envelope&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>BufferPlayer</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/BufferPlayer.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Play the contents of an audio buffer</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Playback rate</li>
<li>Restart trigger</li>
<li>Start position</li>
<li>Loop on/off</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>playbackRate The rate that the buffer should play at.  Value of 1 plays at
the regular rate.  Values &gt; 1 are pitched up.  Values &lt; 1 are pitched down.
Linked to input 0.</li>
<li>restartTrigger Changes of value from 0 -> 1 restart the playback from the
start position.  Linked to input 1.</li>
<li>startPosition The position at which playback should begin.  Values between
0 (the beginning of the buffer) and 1 (the end of the buffer).  Linked to
input 2.</li>
<li>loop Whether the buffer should loop when it reaches the end.  Linked to
input 3</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer</em> buffer The buffer to play.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [playbackRate=1] The initial playback rate.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [startPosition=0] The initial start position.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [loop=0] Initial value for whether to loop.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">BufferPlayer</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">buffer</span><span class="p">,</span> <span class="nx">playbackRate</span><span class="p">,</span> <span class="nx">startPosition</span><span class="p">,</span>
                            <span class="nx">loop</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="nx">startPosition</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">playbackRate</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">playbackRate</span> <span class="o">||</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">restartTrigger</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">startPosition</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">startPosition</span> <span class="o">||</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">loop</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nx">loop</span> <span class="o">||</span> <span class="mi">0</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">restartTriggerOn</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">playing</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">BufferPlayer</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BufferPlayer</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="c1">// Cache local variables</span>
    <span class="kd">var</span> <span class="nx">buffer</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">buffer</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">position</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">position</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">playing</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">playing</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">restartTriggerOn</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">restartTriggerOn</span><span class="p">;</span>

    <span class="c1">// Crap load of parameters</span>
    <span class="kd">var</span> <span class="nx">playbackRateParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">playbackRate</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">playbackRate</span><span class="p">,</span> <span class="nx">playbackRateChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">playbackRateParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">playbackRate</span> <span class="o">=</span> <span class="nx">playbackRateParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">playbackRateChannel</span> <span class="o">=</span> <span class="nx">playbackRateParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">restartTriggerParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">restartTrigger</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">restartTrigger</span><span class="p">,</span> <span class="nx">restartTriggerChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">restartTriggerParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">restartTrigger</span> <span class="o">=</span> <span class="nx">restartTriggerParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">restartTriggerChannel</span> <span class="o">=</span> <span class="nx">restartTriggerParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">startPositionParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">startPosition</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">startPosition</span><span class="p">,</span> <span class="nx">startPositionChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">startPositionParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">startPosition</span> <span class="o">=</span> <span class="nx">startPositionParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">startPositionChannel</span> <span class="o">=</span> <span class="nx">startPositionParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">loopParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">loop</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">loop</span><span class="p">,</span> <span class="nx">loopChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">loopParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">loop</span> <span class="o">=</span> <span class="nx">loopParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">loopChannel</span> <span class="o">=</span> <span class="nx">loopParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>


    <span class="k">if</span> <span class="p">(</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="p">(</span><span class="o">!</span><span class="nx">restartTriggerChannel</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">playing</span><span class="p">))</span> <span class="p">{</span>
        <span class="c1">// No buffer data, or chance of starting playing in this block, so</span>
        <span class="c1">// we can just send an empty buffer and return</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">playbackRateChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">playbackRate</span> <span class="o">=</span> <span class="nx">playbackRateChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">restartTriggerChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">restartTrigger</span> <span class="o">=</span> <span class="nx">restartTriggerChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">loopChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">loop</span> <span class="o">=</span> <span class="nx">loopChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">restartTrigger</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">restartTriggerOn</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Trigger moved from &lt;=0 to &gt;0, so we restart playback from</span>
            <span class="c1">// startPosition</span>
            <span class="nx">position</span> <span class="o">=</span> <span class="nx">startPosition</span><span class="p">;</span>
            <span class="nx">restartTriggerOn</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="nx">playing</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">restartTrigger</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">restartTriggerOn</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Trigger moved back to &lt;= 0</span>
            <span class="nx">restartTriggerOn</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">playing</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
                <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
                <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">position</span><span class="p">)];</span>
            <span class="p">}</span>
            <span class="nx">position</span> <span class="o">+=</span> <span class="nx">playbackRate</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">position</span> <span class="o">&gt;=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">loop</span><span class="p">)</span> <span class="p">{</span>
                    <span class="c1">// Back to the start</span>
                    <span class="nx">position</span> <span class="o">%=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span>
                    <span class="c1">// Finish playing until a new restart trigger</span>
                    <span class="nx">playing</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="c1">// Give zeros until we restart</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
                <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">playing</span> <span class="o">=</span> <span class="nx">playing</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="nx">position</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">restartTriggerOn</span> <span class="o">=</span> <span class="nx">restartTriggerOn</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BufferPlayer</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;Buffer player&#39;</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Gain</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/Gain.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Simple gain control</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Gain</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>gain The amount of gain.  Linked to input 1.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [gain=1] Initial gain.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Gain</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">gain</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">gain</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">gain</span> <span class="o">||</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Gain</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Gain</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">gainParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">gain</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">gain</span><span class="p">,</span> <span class="nx">gainChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">gainParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">gain</span> <span class="o">=</span> <span class="nx">gainParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">gainChannel</span> <span class="o">=</span> <span class="nx">gainParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">gainChannel</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">gain</span> <span class="o">=</span> <span class="nx">gainChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">*</span> <span class="nx">gain</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Gain</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;Gain&#39;</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Pan</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/Pan.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Position a single-channel input in stereo space</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Pan Position</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Panned audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>pan The pan position.  Values between 0 (hard-left) and 1 (hard-right).
Linked to input 1.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [pan=0.5] The initial pan position.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Pan</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">pan</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="c1">// Hardcode two output channels</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">pan</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">pan</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">pan</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">pan</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Pan</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Pan</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">leftOutputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">rightOutputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">panParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">pan</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">pan</span><span class="p">,</span> <span class="nx">panChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">panParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">pan</span> <span class="o">=</span> <span class="nx">panParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">panChannel</span> <span class="o">=</span> <span class="nx">panParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">panChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">pan</span> <span class="o">=</span> <span class="nx">panChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">scaledPan</span> <span class="o">=</span> <span class="nx">pan</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="c1">// TODO: Use sine/cos tables?</span>
        <span class="nx">leftOutputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">scaledPan</span><span class="p">);</span>
        <span class="nx">rightOutputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">scaledPan</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Pan</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Stereo Panner&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>UpMixer</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/UpMixer.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Upmix an input to a constant number of output channels</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Upmixed audio</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> outputChannels The number of output channels.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">UpMixer</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">outputChannels</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">outputChannels</span> <span class="o">=</span> <span class="nx">outputChannels</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">outputChannels</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">UpMixer</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">UpMixer</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">outputChannels</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">outputChannels</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">outputChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span> <span class="o">%</span> <span class="nx">numberOfChannels</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="nx">outputChannel</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">inputChannel</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">UpMixer</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;UpMixer&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>CrossFade</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/CrossFade.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Equal-power cross-fade between two signals</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio 1</li>
<li>Audio 2</li>
<li>Fade Position</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Mixed audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>position The fade position.  Values between 0 (Audio 1 only) and 1 (Audio
2 only).  Linked to input 2.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [position=0.5] The initial fade position.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">CrossFade</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">position</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">position</span> <span class="o">||</span> <span class="mf">0.5</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">CrossFade</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">CrossFade</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBufferA</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">inputBufferB</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="kd">var</span> <span class="nx">inputChannelsA</span> <span class="o">=</span> <span class="nx">inputBufferA</span><span class="p">.</span><span class="nx">channels</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">inputChannelsB</span> <span class="o">=</span> <span class="nx">inputBufferB</span><span class="p">.</span><span class="nx">channels</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">outputChannels</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBufferA</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">&amp;&amp;</span> <span class="nx">inputBufferB</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">positionParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">position</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">position</span><span class="p">,</span> <span class="nx">positionChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">positionParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">position</span> <span class="o">=</span> <span class="nx">positionParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">positionChannel</span> <span class="o">=</span> <span class="nx">positionParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">positionChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">position</span> <span class="o">=</span> <span class="nx">positionChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>

        <span class="kd">var</span> <span class="nx">tableLength</span> <span class="o">=</span> <span class="nx">Sine</span><span class="p">.</span><span class="nx">TABLE</span><span class="p">.</span><span class="nx">length</span> <span class="o">/</span> <span class="mi">4</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">scaledPosition</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">position</span> <span class="o">*</span> <span class="nx">tableLength</span><span class="p">);</span>
        <span class="c1">// TODO: Use sine/cos tables?</span>
        <span class="kd">var</span> <span class="nx">gainA</span> <span class="o">=</span> <span class="nx">Sine</span><span class="p">.</span><span class="nx">TABLE</span><span class="p">[</span><span class="nx">scaledPosition</span> <span class="o">+</span> <span class="nx">tableLength</span><span class="p">];</span>
        <span class="kd">var</span> <span class="nx">gainB</span> <span class="o">=</span> <span class="nx">Sine</span><span class="p">.</span><span class="nx">TABLE</span><span class="p">[</span><span class="nx">scaledPosition</span><span class="p">];</span>

        <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBufferA</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">inputChannelA</span> <span class="o">=</span> <span class="nx">inputChannelsA</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">inputChannelB</span> <span class="o">=</span> <span class="nx">inputChannelsB</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputChannels</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>

            <span class="kd">var</span> <span class="nx">valueA</span><span class="p">,</span> <span class="nx">valueB</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">inputBufferA</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">valueA</span> <span class="o">=</span> <span class="nx">inputChannelA</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">valueA</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">inputBufferB</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">valueB</span> <span class="o">=</span> <span class="nx">inputChannelB</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">valueB</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">valueA</span> <span class="o">*</span> <span class="nx">gainA</span> <span class="o">+</span>
                <span class="nx">valueB</span> <span class="o">*</span> <span class="nx">gainB</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">CrossFade</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Cross Fader&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>LinearCrossFade</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/LinearCrossFade.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Linear cross-fade between two signals</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio 1</li>
<li>Audio 2</li>
<li>Fade Position</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Mixed audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>position The fade position.  Values between 0 (Audio 1 only) and 1 (Audio
2 only).  Linked to input 2.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [position=0.5] The initial fade position.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">LinearCrossFade</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">position</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">position</span> <span class="o">||</span> <span class="mf">0.5</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">LinearCrossFade</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">LinearCrossFade</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBufferA</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">inputBufferB</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="kd">var</span> <span class="nx">inputChannelsA</span> <span class="o">=</span> <span class="nx">inputBufferA</span><span class="p">.</span><span class="nx">channels</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">inputChannelsB</span> <span class="o">=</span> <span class="nx">inputBufferB</span><span class="p">.</span><span class="nx">channels</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">outputChannels</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBufferA</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">||</span> <span class="nx">inputBufferB</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">positionParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">position</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">position</span><span class="p">,</span> <span class="nx">positionChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">positionParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">position</span> <span class="o">=</span> <span class="nx">positionParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">positionChannel</span> <span class="o">=</span> <span class="nx">positionParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">positionChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">position</span> <span class="o">=</span> <span class="nx">positionChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>

        <span class="kd">var</span> <span class="nx">gainA</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nx">position</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">gainB</span> <span class="o">=</span> <span class="nx">position</span><span class="p">;</span>

        <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBufferA</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">inputChannelA</span> <span class="o">=</span> <span class="nx">inputChannelsA</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">inputChannelB</span> <span class="o">=</span> <span class="nx">inputChannelsB</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputChannels</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>

            <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">inputChannelA</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">*</span> <span class="nx">gainA</span> <span class="o">+</span>
                               <span class="nx">inputChannelB</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">*</span> <span class="nx">gainB</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">LinearCrossFade</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Linear Cross Fader&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Limiter</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/Limiter.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>A simple (and frankly shoddy) zero-lookahead limiter.</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Threshold</li>
<li>Attack</li>
<li>Release</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Limited audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>threshold The limiter threshold.  Linked to input 1.</li>
<li>attack The attack time in seconds. Linked to input 2.</li>
<li>release The release time in seconds.  Linked to input 3.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletGroup
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [threshold=0.95] The initial threshold.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [attack=0.01] The initial attack time.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [release=0.4] The initial release time.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Limiter</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">threshold</span><span class="p">,</span> <span class="nx">attack</span><span class="p">,</span> <span class="nx">release</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletGroup</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

    <span class="c1">// Parameters</span>
    <span class="kd">var</span> <span class="nx">attack</span> <span class="o">=</span> <span class="nx">attack</span> <span class="o">||</span> <span class="mf">0.01</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">attackNode</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ParameterNode</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">attack</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">attack</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">attackNode</span><span class="p">.</span><span class="nx">parameter</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">release</span> <span class="o">=</span> <span class="nx">release</span> <span class="o">||</span> <span class="mf">0.4</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">releaseNode</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ParameterNode</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">release</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">release</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">releaseNode</span><span class="p">.</span><span class="nx">parameter</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">amplitude</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Amplitude</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">limitFromAmplitude</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">LimitFromAmplitude</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">threshold</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">threshold</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">limitFromAmplitude</span><span class="p">.</span><span class="nx">threshold</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">amplitude</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">limitFromAmplitude</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">limitFromAmplitude</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">attackNode</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">releaseNode</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">attackNode</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">amplitude</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">releaseNode</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">amplitude</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">amplitude</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">limitFromAmplitude</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">limitFromAmplitude</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Limiter</span><span class="p">,</span> <span class="nx">AudioletGroup</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Limiter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Limiter&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Helper node which limits a signal based on an amplitude input.</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Amplitude</li>
<li>Threshold</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Limited audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>threshold The limiter threshold.  Linked to input 2.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [threshold=0.95] The initial threshold.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">LimitFromAmplitude</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">threshold</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">threshold</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">threshold</span> <span class="o">||</span> <span class="mf">0.95</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">LimitFromAmplitude</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">LimitFromAmplitude</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">amplitudeBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">amplitudeChannel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">||</span> <span class="nx">amplitudeBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">thresholdParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">threshold</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">threshold</span><span class="p">,</span> <span class="nx">thresholdChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">thresholdParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">threshold</span> <span class="o">=</span> <span class="nx">thresholdParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">thresholdChannel</span> <span class="o">=</span> <span class="nx">thresholdParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">amplitude</span> <span class="o">=</span> <span class="nx">amplitudeChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">thresholdChannel</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">threshold</span> <span class="o">=</span> <span class="nx">thresholdChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="p">}</span>

            <span class="kd">var</span> <span class="nx">diff</span> <span class="o">=</span> <span class="nx">amplitude</span> <span class="o">-</span> <span class="nx">threshold</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="nx">diff</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">LimitFromAmplitude</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;Limit From Amplitude&#39;</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>BiquadFilter</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/BiquadFilter.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Generic biquad filter.  The coefficients (a0, a1, a2, b0, b1 and b2) are set
using the calculateCoefficients function, which should be overridden and
will be called automatically when new values are needed.</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Filter frequency</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Filtered audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>frequency The filter frequency.  Linked to input 1.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> frequency The initial frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">BiquadFilter</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

    <span class="c1">// Same number of output channels as input channels</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">frequency</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">frequency</span> <span class="o">||</span> <span class="mi">22100</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lastFrequency</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span> <span class="c1">// See if we need to recalculate coefficients</span>

    <span class="c1">// Delayed values</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">xValues</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">yValues</span> <span class="o">=</span> <span class="p">[];</span>

    <span class="c1">// Coefficients</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">b0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">b1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">b2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">BiquadFilter</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Calculate the biquad filter coefficients.  This should be overridden.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> frequency The filter frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BiquadFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">calculateCoefficients</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BiquadFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">xValueArray</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">xValues</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">yValueArray</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">yValues</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">inputChannels</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">outputChannels</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">inputChannels</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">));</span>
        <span class="nx">outputChannels</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">));</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&gt;=</span> <span class="nx">xValueArray</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">xValueArray</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]);</span>
            <span class="nx">yValueArray</span><span class="p">.</span><span class="nx">push</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">frequencyParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">frequency</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">frequency</span><span class="p">,</span> <span class="nx">frequencyChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">frequencyParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">frequency</span> <span class="o">=</span> <span class="nx">frequencyParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">frequencyChannel</span> <span class="o">=</span> <span class="nx">frequencyParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>


    <span class="kd">var</span> <span class="nx">lastFrequency</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastFrequency</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">a0</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">a0</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">a1</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">a1</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">a2</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">a2</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">b0</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">b0</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">b1</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">b1</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">b2</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">b2</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">frequencyChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">frequency</span> <span class="o">=</span> <span class="nx">frequencyChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">frequency</span> <span class="o">!=</span> <span class="nx">lastFrequency</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Recalculate and make the coefficients local</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">calculateCoefficients</span><span class="p">(</span><span class="nx">frequency</span><span class="p">);</span>
            <span class="nx">lastFrequency</span> <span class="o">=</span> <span class="nx">frequency</span><span class="p">;</span>
            <span class="nx">a0</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">a0</span><span class="p">;</span>
            <span class="nx">a1</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">a1</span><span class="p">;</span>
            <span class="nx">a2</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">a2</span><span class="p">;</span>
            <span class="nx">b0</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">b0</span><span class="p">;</span>
            <span class="nx">b1</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">b1</span><span class="p">;</span>
            <span class="nx">b2</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">b2</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputChannels</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputChannels</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>

            <span class="kd">var</span> <span class="nx">xValues</span> <span class="o">=</span> <span class="nx">xValueArray</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">x1</span> <span class="o">=</span> <span class="nx">xValues</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">x2</span> <span class="o">=</span> <span class="nx">xValues</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">yValues</span> <span class="o">=</span> <span class="nx">yValueArray</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">y1</span> <span class="o">=</span> <span class="nx">yValues</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">y2</span> <span class="o">=</span> <span class="nx">yValues</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>

            <span class="kd">var</span> <span class="nx">x0</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">y0</span> <span class="o">=</span> <span class="p">(</span><span class="nx">b0</span> <span class="o">/</span> <span class="nx">a0</span><span class="p">)</span> <span class="o">*</span> <span class="nx">x0</span> <span class="o">+</span>
                     <span class="p">(</span><span class="nx">b1</span> <span class="o">/</span> <span class="nx">a0</span><span class="p">)</span> <span class="o">*</span> <span class="nx">x1</span> <span class="o">+</span>
                     <span class="p">(</span><span class="nx">b2</span> <span class="o">/</span> <span class="nx">a0</span><span class="p">)</span> <span class="o">*</span> <span class="nx">x2</span> <span class="o">-</span>
                     <span class="p">(</span><span class="nx">a1</span> <span class="o">/</span> <span class="nx">a0</span><span class="p">)</span> <span class="o">*</span> <span class="nx">y1</span> <span class="o">-</span>
                     <span class="p">(</span><span class="nx">a2</span> <span class="o">/</span> <span class="nx">a0</span><span class="p">)</span> <span class="o">*</span> <span class="nx">y2</span><span class="p">;</span>

            <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">y0</span><span class="p">;</span>


            <span class="nx">xValues</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">x0</span><span class="p">;</span>
            <span class="nx">xValues</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">x1</span><span class="p">;</span>
            <span class="nx">yValues</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nx">y0</span><span class="p">;</span>
            <span class="nx">yValues</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">y1</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lastFrequency</span> <span class="o">=</span> <span class="nx">lastFrequency</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BiquadFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Biquad Filter&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>LowPassFilter</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/LowPassFilter.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Low-pass filter</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Filter frequency</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Filtered audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>frequency The filter frequency.  Linked to input 1.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> BiquadFilter
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> frequency The initial frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">LowPassFilter</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">BiquadFilter</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">LowPassFilter</span><span class="p">,</span> <span class="nx">BiquadFilter</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Calculate the biquad filter coefficients using maths from
http://www.musicdsp.org/files/Audio-EQ-Cookbook.txt</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> frequency The filter frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">LowPassFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">calculateCoefficients</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">w0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">*</span> <span class="nx">frequency</span> <span class="o">/</span>
             <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">cosw0</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">w0</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">sinw0</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">w0</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">alpha</span> <span class="o">=</span> <span class="nx">sinw0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">b0</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="nx">cosw0</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">b1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nx">cosw0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">b2</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">b0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a0</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nx">alpha</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="nx">cosw0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nx">alpha</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">LowPassFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Low Pass Filter&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>HighPassFilter</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/HighPassFilter.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>High-pass filter</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Filter frequency</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Filtered audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>frequency The filter frequency.  Linked to input 1.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> BiquadFilter
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> frequency The initial frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">HighPassFilter</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">BiquadFilter</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">HighPassFilter</span><span class="p">,</span> <span class="nx">BiquadFilter</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Calculate the biquad filter coefficients using maths from
http://www.musicdsp.org/files/Audio-EQ-Cookbook.txt</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> frequency The filter frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">HighPassFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">calculateCoefficients</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">w0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">*</span> <span class="nx">frequency</span> <span class="o">/</span>
             <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">cosw0</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">w0</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">sinw0</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">w0</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">alpha</span> <span class="o">=</span> <span class="nx">sinw0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">b0</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="nx">cosw0</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">b1</span> <span class="o">=</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="nx">cosw0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">b2</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">b0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a0</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nx">alpha</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="nx">cosw0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nx">alpha</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">HighPassFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;High Pass Filter&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>BandPassFilter</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/BandPassFilter.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Band-pass filter</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Filter frequency</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Filtered audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>frequency The filter frequency.  Linked to input 1.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> BiquadFilter
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> frequency The initial frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">BandPassFilter</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">BiquadFilter</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">BandPassFilter</span><span class="p">,</span> <span class="nx">BiquadFilter</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Calculate the biquad filter coefficients using maths from
http://www.musicdsp.org/files/Audio-EQ-Cookbook.txt</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> frequency The filter frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BandPassFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">calculateCoefficients</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">w0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">*</span> <span class="nx">frequency</span> <span class="o">/</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">cosw0</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">w0</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">sinw0</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">w0</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">alpha</span> <span class="o">=</span> <span class="nx">sinw0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">b0</span> <span class="o">=</span> <span class="nx">alpha</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">b1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">b2</span> <span class="o">=</span> <span class="o">-</span><span class="nx">alpha</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a0</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nx">alpha</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="nx">cosw0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nx">alpha</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BandPassFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Band Pass Filter&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>BandRejectFilter</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/BandRejectFilter.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Band-reject filter</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Filter frequency</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Filtered audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>frequency The filter frequency.  Linked to input 1.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> BiquadFilter
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> frequency The initial frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">BandRejectFilter</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">BiquadFilter</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">BandRejectFilter</span><span class="p">,</span> <span class="nx">BiquadFilter</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Calculate the biquad filter coefficients using maths from
http://www.musicdsp.org/files/Audio-EQ-Cookbook.txt</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> frequency The filter frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BandRejectFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">calculateCoefficients</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">w0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">*</span> <span class="nx">frequency</span> <span class="o">/</span>
             <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">cosw0</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">w0</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">sinw0</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">w0</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">alpha</span> <span class="o">=</span> <span class="nx">sinw0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">b0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">b1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="nx">cosw0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">b2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a0</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nx">alpha</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="nx">cosw0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nx">alpha</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BandRejectFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Band Reject Filter&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>AllPassFilter</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/AllPassFilter.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>All-pass filter</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Filter frequency</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Filtered audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>frequency The filter frequency.  Linked to input 1.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> BiquadFilter
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> frequency The initial frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">AllPassFilter</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">BiquadFilter</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="nx">frequency</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">AllPassFilter</span><span class="p">,</span> <span class="nx">BiquadFilter</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Calculate the biquad filter coefficients using maths from
http://www.musicdsp.org/files/Audio-EQ-Cookbook.txt</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> frequency The filter frequency.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AllPassFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">calculateCoefficients</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">frequency</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">w0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">*</span> <span class="nx">frequency</span> <span class="o">/</span>
             <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">cosw0</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">w0</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">sinw0</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">w0</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">alpha</span> <span class="o">=</span> <span class="nx">sinw0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">b0</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nx">alpha</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">b1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="nx">cosw0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">b2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nx">alpha</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a0</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nx">alpha</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="nx">cosw0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">a2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nx">alpha</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">AllPassFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;All Pass Filter&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>DCFilter</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/DCFilter.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Filter for leaking DC offset.  Maths is taken from
https://ccrma.stanford.edu/~jos/filters/DC_Blocker.html</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Filter coefficient</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Filtered audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>coefficient The filter coefficient.  Linked to input 1.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [coefficient=0.995] The initial coefficient.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">DCFilter</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">coefficient</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

    <span class="c1">// Same number of output channels as input channels</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">coefficient</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">coefficient</span> <span class="o">||</span> <span class="mf">0.995</span><span class="p">);</span>

    <span class="c1">// Delayed values</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">xValues</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">yValues</span> <span class="o">=</span> <span class="p">[];</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">DCFilter</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">DCFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">xValues</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">xValues</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">yValues</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">yValues</span><span class="p">;</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">coefficientParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">coefficient</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">coefficient</span><span class="p">,</span> <span class="nx">coefficientChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">coefficientParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">coefficient</span> <span class="o">=</span> <span class="nx">coefficientParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">coefficientChannel</span> <span class="o">=</span> <span class="nx">coefficientParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&gt;=</span> <span class="nx">xValues</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">xValues</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&gt;=</span> <span class="nx">yValues</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">yValues</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="kd">var</span> <span class="nx">lastX</span> <span class="o">=</span> <span class="nx">xValues</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="kd">var</span> <span class="nx">lastY</span> <span class="o">=</span> <span class="nx">yValues</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>

        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">coefficientChannel</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">coefficient</span> <span class="o">=</span> <span class="nx">coefficientChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="p">}</span>

            <span class="kd">var</span> <span class="nx">x0</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">y0</span> <span class="o">=</span> <span class="nx">x0</span> <span class="o">-</span> <span class="nx">lastX</span> <span class="o">+</span> <span class="nx">coefficient</span> <span class="o">*</span> <span class="nx">lastY</span><span class="p">;</span>

            <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">y0</span><span class="p">;</span>

            <span class="nx">lastX</span> <span class="o">=</span> <span class="nx">x0</span><span class="p">;</span>
            <span class="nx">lastY</span> <span class="o">=</span> <span class="nx">y0</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">xValues</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">lastX</span><span class="p">;</span>
        <span class="nx">yValues</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">lastY</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">DCFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;DC Filter&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Lag</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/Lag.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Exponential lag for smoothing signals.</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Value</li>
<li>Lag time</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Lagged value</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>value The value to lag.  Linked to input 0.</li>
<li>lag The 60dB lag time. Linked to input 1.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [value=0] The initial value.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [lagTime=1] The initial lag time.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Lag</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">lagTime</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">value</span> <span class="o">||</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lag</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">lagTime</span> <span class="o">||</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lastValue</span> <span class="o">=</span> <span class="nx">value</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">log001</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mf">0.001</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Lag</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Lag</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">sampleRate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">log001</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">log001</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">valueParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">valueChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">valueParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">value</span> <span class="o">=</span> <span class="nx">valueParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">valueChannel</span> <span class="o">=</span> <span class="nx">valueParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">lagParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">lag</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">lag</span><span class="p">,</span> <span class="nx">lagChannel</span><span class="p">,</span> <span class="nx">coefficient</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">lagParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">lag</span> <span class="o">=</span> <span class="nx">lagParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
        <span class="nx">coefficient</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="nx">log001</span> <span class="o">/</span> <span class="p">(</span><span class="nx">lag</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">lagChannel</span> <span class="o">=</span> <span class="nx">lagParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">lastValue</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastValue</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">valueChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">value</span> <span class="o">=</span> <span class="nx">valueChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="nx">coefficient</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="nx">log001</span> <span class="o">/</span> <span class="p">(</span><span class="nx">lag</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">));</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">lagChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">lag</span> <span class="o">=</span> <span class="nx">lagChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">output</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="nx">coefficient</span><span class="p">)</span> <span class="o">*</span> <span class="nx">value</span><span class="p">)</span> <span class="o">+</span>
                     <span class="p">(</span><span class="nx">coefficient</span> <span class="o">*</span> <span class="nx">lastValue</span><span class="p">);</span>
        <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">output</span><span class="p">;</span>
        <span class="nx">lastValue</span> <span class="o">=</span> <span class="nx">output</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lastValue</span> <span class="o">=</span> <span class="nx">lastValue</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Lag</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Lag&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Delay</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/Delay.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>A simple delay line.</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Delay Time</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Delayed audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>delayTime The delay time in seconds.  Linked to input 1.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> maximumDelayTime The largest allowable delay time.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> delayTime The initial delay time.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Delay</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">maximumDelayTime</span><span class="p">,</span> <span class="nx">delayTime</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">maximumDelayTime</span> <span class="o">=</span> <span class="nx">maximumDelayTime</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">delayTime</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">delayTime</span> <span class="o">||</span> <span class="mi">1</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">bufferSize</span> <span class="o">=</span> <span class="nx">maximumDelayTime</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">buffers</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">readWriteIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Delay</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Delay</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">maximumDelayTime</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">maximumDelayTime</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">sampleRate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">delayTimeParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">delayTime</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">delayTime</span><span class="p">,</span> <span class="nx">delayTimeChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">delayTimeParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">delayTime</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">delayTimeParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">()</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">delayTimeChannel</span> <span class="o">=</span> <span class="nx">delayTimeParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">buffers</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">buffers</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">readWriteIndex</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">readWriteIndex</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">inputChannels</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">outputChannels</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">inputChannels</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">));</span>
        <span class="nx">outputChannels</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">));</span>
        <span class="c1">// Create buffer for channel if it doesn&#39;t already exist</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&gt;=</span> <span class="nx">buffers</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">bufferSize</span> <span class="o">=</span> <span class="nx">maximumDelayTime</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">;</span>
            <span class="nx">buffers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">Float32Array</span><span class="p">(</span><span class="nx">bufferSize</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">}</span>


    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">delayTimeChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">delayTime</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">delayTimeChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputChannels</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputChannels</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">buffer</span> <span class="o">=</span> <span class="nx">buffers</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">[</span><span class="nx">readWriteIndex</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">buffer</span><span class="p">[</span><span class="nx">readWriteIndex</span><span class="p">]</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">buffer</span><span class="p">[</span><span class="nx">readWriteIndex</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">readWriteIndex</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">readWriteIndex</span> <span class="o">&gt;=</span> <span class="nx">delayTime</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">readWriteIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">readWriteIndex</span> <span class="o">=</span> <span class="nx">readWriteIndex</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Delay</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Delay&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>FeedbackDelay</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/FeedbackDelay.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Delay line with feedback</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Delay Time</li>
<li>Feedback</li>
<li>Mix</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Delayed audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>delayTime The delay time in seconds.  Linked to input 1.</li>
<li>feedback The amount of feedback.  Linked to input 2.</li>
<li>mix The amount of delay to mix into the dry signal.  Linked to input 3.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> maximumDelayTime The largest allowable delay time.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> delayTime The initial delay time.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> feedabck The initial feedback amount.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> mix The initial mix amount.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">FeedbackDelay</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">maximumDelayTime</span><span class="p">,</span> <span class="nx">delayTime</span><span class="p">,</span> <span class="nx">feedback</span><span class="p">,</span>
                             <span class="nx">mix</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">maximumDelayTime</span> <span class="o">=</span> <span class="nx">maximumDelayTime</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">delayTime</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">delayTime</span> <span class="o">||</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">feedback</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">feedback</span> <span class="o">||</span> <span class="mf">0.5</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">mix</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nx">mix</span> <span class="o">||</span> <span class="mi">1</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">bufferSize</span> <span class="o">=</span> <span class="nx">maximumDelayTime</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">buffers</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">readWriteIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">FeedbackDelay</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">FeedbackDelay</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">maximumDelayTime</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">maximumDelayTime</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">sampleRate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">delayTimeParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">delayTime</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">delayTime</span><span class="p">,</span> <span class="nx">delayTimeChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">delayTimeParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">delayTime</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">delayTimeParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">()</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">delayTimeChannel</span> <span class="o">=</span> <span class="nx">delayTimeParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">feedbackParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">feedback</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">feedback</span><span class="p">,</span> <span class="nx">feedbackChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">feedbackParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">feedback</span> <span class="o">=</span> <span class="nx">feedbackParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">feedbackChannel</span> <span class="o">=</span> <span class="nx">feedbackParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">mixParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">mix</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">mix</span><span class="p">,</span> <span class="nx">mixChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">mixParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">mix</span> <span class="o">=</span> <span class="nx">mixParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">mixChannel</span> <span class="o">=</span> <span class="nx">mixParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>


    <span class="kd">var</span> <span class="nx">buffers</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">buffers</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">readWriteIndex</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">readWriteIndex</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">inputChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">outputChannels</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">numberOfBuffers</span> <span class="o">=</span> <span class="nx">buffers</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">numberOfBuffers</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Create buffer for channel if it doesn&#39;t already exist</span>
        <span class="kd">var</span> <span class="nx">bufferSize</span> <span class="o">=</span> <span class="nx">maximumDelayTime</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">;</span>
        <span class="nx">buffers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">Float32Array</span><span class="p">(</span><span class="nx">bufferSize</span><span class="p">));</span>
    <span class="p">}</span>


    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">delayTimeChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">delayTime</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">delayTimeChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">feedbackChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">feedback</span> <span class="o">=</span> <span class="nx">feedbackChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">mixChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">mix</span> <span class="o">=</span> <span class="nx">mixChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputChannels</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputChannels</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">buffer</span> <span class="o">=</span> <span class="nx">buffers</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">input</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">input</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">input</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="kd">var</span> <span class="nx">output</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">[</span><span class="nx">readWriteIndex</span><span class="p">];</span>
            <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">mix</span> <span class="o">*</span> <span class="nx">output</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="nx">mix</span><span class="p">)</span> <span class="o">*</span> <span class="nx">input</span><span class="p">;</span>
            <span class="nx">buffer</span><span class="p">[</span><span class="nx">readWriteIndex</span><span class="p">]</span> <span class="o">=</span> <span class="nx">input</span> <span class="o">+</span> <span class="nx">feedback</span> <span class="o">*</span> <span class="nx">output</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">readWriteIndex</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">readWriteIndex</span> <span class="o">&gt;=</span> <span class="nx">delayTime</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">readWriteIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">readWriteIndex</span> <span class="o">=</span> <span class="nx">readWriteIndex</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">FeedbackDelay</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Feedback Delay&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>CombFilter</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/CombFilter.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Undamped comb filter</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Delay Time</li>
<li>Decay Time</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Filtered audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>delayTime The delay time in seconds.  Linked to input 1.</li>
<li>decayTime Time for the echoes to decay by 60dB.  Linked to input 0.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> maximumDelayTime The largest allowable delay time.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> delayTime The initial delay time.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> decayTime The initial decay time.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">CombFilter</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">maximumDelayTime</span><span class="p">,</span> <span class="nx">delayTime</span><span class="p">,</span> <span class="nx">decayTime</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">maximumDelayTime</span> <span class="o">=</span> <span class="nx">maximumDelayTime</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">delayTime</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">delayTime</span> <span class="o">||</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">decayTime</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">decayTime</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">bufferSize</span> <span class="o">=</span> <span class="nx">maximumDelayTime</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">buffers</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">readWriteIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">CombFilter</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">CombFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">maximumDelayTime</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">maximumDelayTime</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">sampleRate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">delayTimeParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">delayTime</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">delayTime</span><span class="p">,</span> <span class="nx">delayTimeChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">delayTimeParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">delayTime</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">delayTimeParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">()</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">delayTimeChannel</span> <span class="o">=</span> <span class="nx">delayTimeParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">decayTimeParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">decayTime</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">decayTime</span><span class="p">,</span> <span class="nx">decayTimeChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">decayTimeParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">decayTime</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">decayTimeParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">()</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">decayTimeChannel</span> <span class="o">=</span> <span class="nx">decayTimeParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>


    <span class="kd">var</span> <span class="nx">feedback</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">delayTimeParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nx">decayTimeParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">feedback</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="nx">delayTime</span> <span class="o">/</span> <span class="nx">decayTime</span><span class="p">);</span>
    <span class="p">}</span>



    <span class="kd">var</span> <span class="nx">buffers</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">buffers</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">readWriteIndex</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">readWriteIndex</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">inputChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">outputChannels</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">numberOfBuffers</span> <span class="o">=</span> <span class="nx">buffers</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">numberOfBuffers</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Create buffer for channel if it doesn&#39;t already exist</span>
        <span class="kd">var</span> <span class="nx">bufferSize</span> <span class="o">=</span> <span class="nx">maximumDelayTime</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">;</span>
        <span class="nx">buffers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">Float32Array</span><span class="p">(</span><span class="nx">bufferSize</span><span class="p">));</span>
    <span class="p">}</span>


    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">delayTimeChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">delayTime</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">delayTimeChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">decayTimeChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">decayTime</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">decayTimeChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">delayTimeChannel</span> <span class="o">||</span> <span class="nx">decayTimeChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">feedback</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="nx">delayTime</span> <span class="o">/</span> <span class="nx">decayTime</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputChannels</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputChannels</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">buffer</span> <span class="o">=</span> <span class="nx">buffers</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">output</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">[</span><span class="nx">readWriteIndex</span><span class="p">];</span>
            <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">output</span><span class="p">;</span>
            <span class="nx">buffer</span><span class="p">[</span><span class="nx">readWriteIndex</span><span class="p">]</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">+</span>
                                     <span class="nx">feedback</span> <span class="o">*</span> <span class="nx">output</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">readWriteIndex</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">readWriteIndex</span> <span class="o">&gt;=</span> <span class="nx">delayTime</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">readWriteIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">readWriteIndex</span> <span class="o">=</span> <span class="nx">readWriteIndex</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">CombFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Comb Filter&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>DampedCombFilter</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/DampedCombFilter.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Damped comb filter</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Delay Time</li>
<li>Decay Time</li>
<li>Damping</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Filtered audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>delayTime The delay time in seconds.  Linked to input 1.</li>
<li>decayTime Time for the echoes to decay by 60dB.  Linked to input 2.</li>
<li>damping The amount of high-frequency damping of echoes.  Linked to input 3.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> maximumDelayTime The largest allowable delay time.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> delayTime The initial delay time.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> decayTime The initial decay time.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> damping The initial amount of damping.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">DampedCombFilter</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">maximumDelayTime</span><span class="p">,</span> <span class="nx">delayTime</span><span class="p">,</span>
                                <span class="nx">decayTime</span><span class="p">,</span> <span class="nx">damping</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">maximumDelayTime</span> <span class="o">=</span> <span class="nx">maximumDelayTime</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">delayTime</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">delayTime</span> <span class="o">||</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">decayTime</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">decayTime</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">damping</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nx">damping</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">bufferSize</span> <span class="o">=</span> <span class="nx">maximumDelayTime</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">buffers</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">readWriteIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">filterStore</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">DampedCombFilter</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">DampedCombFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">maximumDelayTime</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">maximumDelayTime</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">sampleRate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">delayTimeParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">delayTime</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">delayTime</span><span class="p">,</span> <span class="nx">delayTimeChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">delayTimeParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">delayTime</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">delayTimeParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">()</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">delayTimeChannel</span> <span class="o">=</span> <span class="nx">delayTimeParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">decayTimeParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">decayTime</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">decayTime</span><span class="p">,</span> <span class="nx">decayTimeChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">decayTimeParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">decayTime</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">decayTimeParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">()</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">decayTimeChannel</span> <span class="o">=</span> <span class="nx">decayTimeParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">dampingParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">damping</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">damping</span><span class="p">,</span> <span class="nx">dampingChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">dampingParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">damping</span> <span class="o">=</span> <span class="nx">dampingParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">dampingChannel</span> <span class="o">=</span> <span class="nx">dampingParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>


    <span class="kd">var</span> <span class="nx">feedback</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">delayTimeParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nx">decayTimeParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">feedback</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="nx">delayTime</span> <span class="o">/</span> <span class="nx">decayTime</span><span class="p">);</span>
    <span class="p">}</span>



    <span class="kd">var</span> <span class="nx">buffers</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">buffers</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">readWriteIndex</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">readWriteIndex</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">filterStore</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">filterStore</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">inputChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">outputChannels</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">numberOfBuffers</span> <span class="o">=</span> <span class="nx">buffers</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">numberOfBuffers</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Create buffer for channel if it doesn&#39;t already exist</span>
        <span class="kd">var</span> <span class="nx">bufferSize</span> <span class="o">=</span> <span class="nx">maximumDelayTime</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">;</span>
        <span class="nx">buffers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">Float32Array</span><span class="p">(</span><span class="nx">bufferSize</span><span class="p">));</span>
    <span class="p">}</span>


    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">delayTimeChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">delayTime</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">delayTimeChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">decayTimeChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">decayTime</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">decayTimeChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">*</span> <span class="nx">sampleRate</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">dampingChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">damping</span> <span class="o">=</span> <span class="nx">dampingChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">delayTimeChannel</span> <span class="o">||</span> <span class="nx">decayTimeChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">feedback</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="nx">delayTime</span> <span class="o">/</span> <span class="nx">decayTime</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputChannels</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputChannels</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">buffer</span> <span class="o">=</span> <span class="nx">buffers</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">output</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">[</span><span class="nx">readWriteIndex</span><span class="p">];</span>
            <span class="nx">filterStore</span> <span class="o">=</span> <span class="p">(</span><span class="nx">output</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="nx">damping</span><span class="p">))</span> <span class="o">+</span>
                          <span class="p">(</span><span class="nx">filterStore</span> <span class="o">*</span> <span class="nx">damping</span><span class="p">);</span>
            <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">output</span><span class="p">;</span>
            <span class="nx">buffer</span><span class="p">[</span><span class="nx">readWriteIndex</span><span class="p">]</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">+</span>
                                     <span class="nx">feedback</span> <span class="o">*</span> <span class="nx">filterStore</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">readWriteIndex</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">readWriteIndex</span> <span class="o">&gt;=</span> <span class="nx">delayTime</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">readWriteIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">readWriteIndex</span> <span class="o">=</span> <span class="nx">readWriteIndex</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">filterStore</span> <span class="o">=</span> <span class="nx">filterStore</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">DampedCombFilter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Damped Comb Filter&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Reverb</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/Reverb.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Port of the Freeverb Schrodoer/Moorer reverb model.  See
https://ccrma.stanford.edu/~jos/pasp/Freeverb.html for a description of how
each part works.</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Mix</li>
<li>Room Size</li>
<li>Damping</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Reverberated Audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>mix The wet/dry mix.  Values between 0 and 1.  Linked to input 1.</li>
<li>roomSize The reverb's room size.  Values between 0 and 1.  Linked to input
2.</li>
<li>damping The amount of high-frequency damping.  Values between 0 and 1.
Linked to input 3.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletGroup
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [mix=0.33] The initial wet/dry mix.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [roomSize=0.5] The initial room size.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [damping=0.5] The initial damping amount.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Reverb</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">mix</span><span class="p">,</span> <span class="nx">roomSize</span><span class="p">,</span> <span class="nx">damping</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

    <span class="c1">// Constants</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">initialMix</span> <span class="o">=</span> <span class="mf">0.33</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">fixedGain</span> <span class="o">=</span> <span class="mf">0.015</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">initialDamping</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">scaleDamping</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">initialRoomSize</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">scaleRoom</span> <span class="o">=</span> <span class="mf">0.28</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">offsetRoom</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">;</span>

    <span class="c1">// Parameters: for 44.1k or 48k</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">combTuning</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1116</span><span class="p">,</span> <span class="mi">1188</span><span class="p">,</span> <span class="mi">1277</span><span class="p">,</span> <span class="mi">1356</span><span class="p">,</span> <span class="mi">1422</span><span class="p">,</span> <span class="mi">1491</span><span class="p">,</span> <span class="mi">1557</span><span class="p">,</span> <span class="mi">1617</span><span class="p">];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">allPassTuning</span> <span class="o">=</span> <span class="p">[</span><span class="mi">556</span><span class="p">,</span> <span class="mi">441</span><span class="p">,</span> <span class="mi">341</span><span class="p">,</span> <span class="mi">225</span><span class="p">];</span>

    <span class="c1">// Controls</span>
    <span class="c1">// Mix control</span>
    <span class="kd">var</span> <span class="nx">mix</span> <span class="o">=</span> <span class="nx">mix</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">initialMix</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">mix</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">mix</span><span class="p">);</span>

    <span class="c1">// Room size control</span>
    <span class="kd">var</span> <span class="nx">roomSize</span> <span class="o">=</span> <span class="nx">roomSize</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">initialRoomSize</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">roomSize</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">roomSize</span><span class="p">);</span>

    <span class="c1">// Damping control</span>
    <span class="kd">var</span> <span class="nx">damping</span> <span class="o">=</span> <span class="nx">damping</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">initialDamping</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">damping</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nx">damping</span><span class="p">);</span>

    <span class="c1">// Damped comb filters</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">combBuffers</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">combIndices</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">filterStores</span> <span class="o">=</span> <span class="p">[];</span>

    <span class="kd">var</span> <span class="nx">numberOfCombs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">combTuning</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfCombs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">combBuffers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">Float32Array</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">combTuning</span><span class="p">[</span><span class="nx">i</span><span class="p">]));</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">combIndices</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">filterStores</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// All-pass filters</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">allPassBuffers</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">allPassIndices</span> <span class="o">=</span> <span class="p">[];</span>

    <span class="kd">var</span> <span class="nx">numberOfFilters</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">allPassTuning</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfFilters</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">allPassBuffers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">Float32Array</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">allPassTuning</span><span class="p">[</span><span class="nx">i</span><span class="p">]));</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">allPassIndices</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Reverb</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Reverb</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="kd">var</span> <span class="nx">mixParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">mix</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">mix</span><span class="p">,</span> <span class="nx">mixChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">mixParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">mix</span> <span class="o">=</span> <span class="nx">mixParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">mixChannel</span> <span class="o">=</span> <span class="nx">mixParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">roomSizeParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">roomSize</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">roomSize</span><span class="p">,</span> <span class="nx">roomSizeChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">roomSizeParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">roomSize</span> <span class="o">=</span> <span class="nx">roomSizeParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">roomSizeChannel</span> <span class="o">=</span> <span class="nx">roomSizeParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">dampingParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">damping</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">damping</span><span class="p">,</span> <span class="nx">dampingChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">dampingParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">damping</span> <span class="o">=</span> <span class="nx">dampingParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">dampingChannel</span> <span class="o">=</span> <span class="nx">dampingParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">numberOfCombs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">combTuning</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">numberOfFilters</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">allPassTuning</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">gain</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">fixedGain</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">combBuffers</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">combBuffers</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">combIndices</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">combIndices</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">filterStores</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">filterStores</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">allPassBuffers</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">allPassBuffers</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">allPassIndices</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">allPassIndices</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">scaleDamping</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">scaleDamping</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">scaleRoom</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">scaleRoom</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">offsetRoom</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">offsetRoom</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">mixChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">mix</span> <span class="o">=</span> <span class="nx">mixChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">roomSizeChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">roomSize</span> <span class="o">=</span> <span class="nx">roomSizeChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">dampingChannel</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">damping</span> <span class="o">=</span> <span class="nx">dampingChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>

        <span class="kd">var</span> <span class="nx">value</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">value</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="nx">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">dryValue</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>

        <span class="nx">value</span> <span class="o">*=</span> <span class="nx">gain</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">gainedValue</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>

        <span class="kd">var</span> <span class="nx">damping</span> <span class="o">=</span> <span class="nx">damping</span> <span class="o">*</span> <span class="nx">scaleDamping</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">feedback</span> <span class="o">=</span> <span class="nx">roomSize</span> <span class="o">*</span> <span class="nx">scaleRoom</span> <span class="o">+</span> <span class="nx">offsetRoom</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfCombs</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">combIndex</span> <span class="o">=</span> <span class="nx">combIndices</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">combBuffer</span> <span class="o">=</span> <span class="nx">combBuffers</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">filterStore</span> <span class="o">=</span> <span class="nx">filterStores</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>

            <span class="kd">var</span> <span class="nx">output</span> <span class="o">=</span> <span class="nx">combBuffer</span><span class="p">[</span><span class="nx">combIndex</span><span class="p">];</span>
            <span class="nx">filterStore</span> <span class="o">=</span> <span class="p">(</span><span class="nx">output</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="nx">damping</span><span class="p">))</span> <span class="o">+</span>
                          <span class="p">(</span><span class="nx">filterStore</span> <span class="o">*</span> <span class="nx">damping</span><span class="p">);</span>
            <span class="nx">value</span> <span class="o">+=</span> <span class="nx">output</span><span class="p">;</span>
            <span class="nx">combBuffer</span><span class="p">[</span><span class="nx">combIndex</span><span class="p">]</span> <span class="o">=</span> <span class="nx">gainedValue</span> <span class="o">+</span> <span class="nx">feedback</span> <span class="o">*</span> <span class="nx">filterStore</span><span class="p">;</span>

            <span class="nx">combIndex</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">combIndex</span> <span class="o">&gt;=</span> <span class="nx">combBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">combIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>


            <span class="nx">combIndices</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">combIndex</span><span class="p">;</span>
            <span class="nx">filterStores</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">filterStore</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">numberOfFilters</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">allPassBuffer</span> <span class="o">=</span> <span class="nx">allPassBuffers</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="kd">var</span> <span class="nx">allPassIndex</span> <span class="o">=</span> <span class="nx">allPassIndices</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>

            <span class="kd">var</span> <span class="nx">input</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">bufferValue</span> <span class="o">=</span> <span class="nx">allPassBuffer</span><span class="p">[</span><span class="nx">allPassIndex</span><span class="p">];</span>
            <span class="nx">value</span> <span class="o">=</span> <span class="o">-</span><span class="nx">value</span> <span class="o">+</span> <span class="nx">bufferValue</span><span class="p">;</span>
            <span class="nx">allPassBuffer</span><span class="p">[</span><span class="nx">allPassIndex</span><span class="p">]</span> <span class="o">=</span> <span class="nx">input</span> <span class="o">+</span> <span class="p">(</span><span class="nx">bufferValue</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">);</span>

            <span class="nx">allPassIndex</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">allPassIndex</span> <span class="o">&gt;=</span> <span class="nx">allPassBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">allPassIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nx">allPassIndices</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">allPassIndex</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">mix</span> <span class="o">*</span> <span class="nx">value</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="nx">mix</span><span class="p">)</span> <span class="o">*</span> <span class="nx">dryValue</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Reverb</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Reverb&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>ReverbB</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/ReverbB.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Port of the Freeverb Schrodoer/Moorer reverb model.  See
https://ccrma.stanford.edu/~jos/pasp/Freeverb.html for a description of how
each part works.  This is an old, slow, crappy version maintained for
backwards compatibility.  It is recommended to that you use Reverb instead.</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Mix</li>
<li>Room Size</li>
<li>Damping</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Reverberated Audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>mix The wet/dry mix.  Values between 0 and 1.  Linked to input 1.</li>
<li>roomSize The reverb's room size.  Values between 0 and 1.  Linked to input
2.</li>
<li>damping The amount of high-frequency damping.  Values between 0 and 1.
Linked to input 3.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletGroup
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [mix=0.33] The initial wet/dry mix.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [roomSize=0.5] The initial room size.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [damping=0.5] The initial damping amount.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">ReverbB</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">mix</span><span class="p">,</span> <span class="nx">roomSize</span><span class="p">,</span> <span class="nx">damping</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletGroup</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

    <span class="c1">// Constants</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">initialMix</span> <span class="o">=</span> <span class="mf">0.33</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">fixedGain</span> <span class="o">=</span> <span class="mf">0.015</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">initialDamping</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">scaleDamping</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">initialRoomSize</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">scaleRoom</span> <span class="o">=</span> <span class="mf">0.28</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">offsetRoom</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">;</span>

    <span class="c1">// Parameters: for 44.1k or 48k</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">combTuning</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1116</span><span class="p">,</span> <span class="mi">1188</span><span class="p">,</span> <span class="mi">1277</span><span class="p">,</span> <span class="mi">1356</span><span class="p">,</span> <span class="mi">1422</span><span class="p">,</span> <span class="mi">1491</span><span class="p">,</span> <span class="mi">1557</span><span class="p">,</span> <span class="mi">1617</span><span class="p">];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">allPassTuning</span> <span class="o">=</span> <span class="p">[</span><span class="mi">556</span><span class="p">,</span> <span class="mi">441</span><span class="p">,</span> <span class="mi">341</span><span class="p">,</span> <span class="mi">225</span><span class="p">];</span>

    <span class="c1">// Controls</span>
    <span class="c1">// Room size control</span>
    <span class="kd">var</span> <span class="nx">roomSize</span> <span class="o">=</span> <span class="nx">roomSize</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">initialRoomSize</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">roomSizeNode</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ParameterNode</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">roomSize</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">roomSizeMulAdd</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MulAdd</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">scaleRoom</span><span class="p">,</span>
                                     <span class="k">this</span><span class="p">.</span><span class="nx">offsetRoom</span><span class="p">);</span>

    <span class="c1">// Damping control</span>
    <span class="kd">var</span> <span class="nx">damping</span> <span class="o">=</span> <span class="nx">damping</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">initialDamping</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">dampingNode</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ParameterNode</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">damping</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">dampingMulAdd</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MulAdd</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">scaleDamping</span><span class="p">);</span>

    <span class="c1">// Access the controls as if this is an AudioletNode, and they are it&#39;s</span>
    <span class="c1">// parameters.</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">roomSize</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">roomSizeNode</span><span class="p">.</span><span class="nx">parameter</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">damping</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">dampingNode</span><span class="p">.</span><span class="nx">parameter</span><span class="p">;</span>

    <span class="c1">// Initial gain control</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">gain</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Gain</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">fixedGain</span><span class="p">);</span>

    <span class="c1">// Eight comb filters and feedback gain converters</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">combFilters</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">fgConverters</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">combTuning</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">delayTime</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">combTuning</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">/</span>
                        <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">combFilters</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DampedCombFilter</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">delayTime</span><span class="p">,</span>
                                                   <span class="nx">delayTime</span><span class="p">);</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">fgConverters</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FeedbackGainToDecayTime</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span>
                                                           <span class="nx">delayTime</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// Four allpass filters</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">allPassFilters</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">allPassTuning</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">allPassFilters</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AllPassFilter</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span>
                                                   <span class="k">this</span><span class="p">.</span><span class="nx">allPassTuning</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">}</span>

    <span class="c1">// Mixer</span>
    <span class="kd">var</span> <span class="nx">mix</span> <span class="o">=</span> <span class="nx">mix</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">initialMix</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">mixer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">LinearCrossFade</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">mix</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">mix</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">mixer</span><span class="p">.</span><span class="nx">position</span><span class="p">;</span>

    <span class="c1">// Connect up the controls</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">mixer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">roomSizeNode</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">roomSizeNode</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">roomSizeMulAdd</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dampingNode</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">dampingNode</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dampingMulAdd</span><span class="p">);</span>

    <span class="c1">// Connect up the gain</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">gain</span><span class="p">);</span>

    <span class="c1">// Connect up the comb filters</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">combFilters</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">gain</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">combFilters</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">combFilters</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">allPassFilters</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>

        <span class="c1">// Controls</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">roomSizeMulAdd</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">fgConverters</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">fgConverters</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">combFilters</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">dampingMulAdd</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">combFilters</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// Connect up the all pass filters</span>
    <span class="kd">var</span> <span class="nx">numberOfAllPassFilters</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">allPassFilters</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfAllPassFilters</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">allPassFilters</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">allPassFilters</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]);</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">mixer</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">lastAllPassIndex</span> <span class="o">=</span> <span class="nx">numberOfAllPassFilters</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">allPassFilters</span><span class="p">[</span><span class="nx">lastAllPassIndex</span><span class="p">].</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">mixer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">mixer</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">ReverbB</span><span class="p">,</span> <span class="nx">AudioletGroup</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">ReverbB</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Reverb B&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Helper node to convert a feedback gain multiplier to a 60db decay time.</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Feedback gain</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Decay time</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> delayTime The delay time in seconds
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">FeedbackGainToDecayTime</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">delayTime</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">delayTime</span> <span class="o">=</span> <span class="nx">delayTime</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lastFeedbackGain</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">decayTime</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">FeedbackGainToDecayTime</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">FeedbackGainToDecayTime</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span>
                                                      <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">channels</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="kd">var</span> <span class="nx">delayTime</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastDelayTime</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">decayTime</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">decayTime</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">lastFeedbackGain</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastFeedbackGain</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">feedbackGain</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">feedbackGain</span> <span class="o">!=</span> <span class="nx">lastFeedbackGain</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">decayTime</span> <span class="o">=</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="nx">delayTime</span> <span class="o">/</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">feedbackGain</span><span class="p">);</span>
            <span class="nx">lastFeedbackGain</span> <span class="o">=</span> <span class="nx">feedbackGain</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">feedbackGain</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">decayTime</span> <span class="o">=</span> <span class="nx">decayTime</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lastFeedbackGain</span> <span class="o">=</span> <span class="nx">lastFeedbackGain</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>SoftClip</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/SoftClip.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>A soft-clipper, which distorts at values over +-0.5.</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Clipped audio</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">SoftClip</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">SoftClip</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">SoftClip</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nx">value</span> <span class="o">-</span> <span class="mf">0.25</span><span class="p">)</span> <span class="o">/</span> <span class="nx">value</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="nx">value</span> <span class="o">-</span> <span class="mf">0.25</span><span class="p">)</span> <span class="o">/</span> <span class="nx">value</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">SoftClip</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;SoftClip&#39;</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>BitCrusher</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/BitCrusher.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Reduce the bitrate of incoming audio</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio 1</li>
<li>Number of bits</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Bit Crushed Audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>bits The number of bit to reduce to.  Linked to input 1.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> bits The initial number of bits.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">BitCrusher</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">bits</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">bits</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">bits</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">BitCrusher</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BitCrusher</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">bitsParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">bits</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">bits</span><span class="p">,</span> <span class="nx">bitsChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">bitsParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">bits</span> <span class="o">=</span> <span class="nx">bitsParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">bitsChannel</span> <span class="o">=</span> <span class="nx">bitsParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">bitsChannel</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">bits</span> <span class="o">=</span> <span class="nx">bitsChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="kd">var</span> <span class="nx">maxValue</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nx">bits</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
            <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">inputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">*</span> <span class="nx">maxValue</span><span class="p">)</span> <span class="o">/</span>
                               <span class="nx">maxValue</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BitCrusher</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;BitCrusher&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Amplitude</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/Amplitude.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Amplitude envelope follower</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Attack time</li>
<li>Release time</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Amplitude envelope</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>attack The attack time of the envelope follower.  Linked to input 1.</li>
<li>release The release time of the envelope follower.  Linked to input 2.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [attack=0.01] The initial attack time in seconds.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [release=0.01] The initial release time in seconds.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Amplitude</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">attack</span><span class="p">,</span> <span class="nx">release</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">followers</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">sampleRate</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">audiolet</span><span class="p">.</span><span class="nx">device</span><span class="p">.</span><span class="nx">sampleRate</span><span class="p">;</span>

    <span class="c1">//        attack = Math.pow(0.01, 1 / (attack * sampleRate));</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">attack</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">attack</span> <span class="o">||</span> <span class="mf">0.01</span><span class="p">);</span>

    <span class="c1">//        release = Math.pow(0.01, 1 / (release * sampleRate));</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">release</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">release</span> <span class="o">||</span> <span class="mf">0.01</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Amplitude</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Amplitude</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">followers</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">followers</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">numberOfFollowers</span> <span class="o">=</span> <span class="nx">followers</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">attackParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">attack</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">attack</span><span class="p">,</span> <span class="nx">attackChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">attackParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">attack</span> <span class="o">=</span> <span class="nx">attackParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">attackChannel</span> <span class="o">=</span> <span class="nx">attackParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">releaseParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">release</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">release</span><span class="p">,</span> <span class="nx">releaseChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">releaseParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">release</span> <span class="o">=</span> <span class="nx">releaseParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">releaseChannel</span> <span class="o">=</span> <span class="nx">releaseParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&gt;</span> <span class="nx">numberOfFollowers</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">followers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">follower</span> <span class="o">=</span> <span class="nx">followers</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>

        <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">attackChannel</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">attack</span> <span class="o">=</span> <span class="nx">attackChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">releaseChannel</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">release</span> <span class="o">=</span> <span class="nx">releaseChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&gt;</span> <span class="nx">follower</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">follower</span> <span class="o">=</span> <span class="nx">attack</span> <span class="o">*</span> <span class="p">(</span><span class="nx">follower</span> <span class="o">-</span> <span class="nx">value</span><span class="p">)</span> <span class="o">+</span> <span class="nx">value</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="nx">follower</span> <span class="o">=</span> <span class="nx">release</span> <span class="o">*</span> <span class="p">(</span><span class="nx">follower</span> <span class="o">-</span> <span class="nx">value</span><span class="p">)</span> <span class="o">+</span> <span class="nx">value</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">follower</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">followers</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">follower</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Amplitude</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>DiscontinuityDetector</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/DiscontinuityDetector.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Detect discontinuities in the input stream.  Looks for consecutive samples
with a difference larger than a threshold value.</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Audio</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> PassThroughNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [threshold=0.2] The threshold value.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Function</em> [callback] Function called if a discontinuity is detected.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">DiscontinuityDetector</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">threshold</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">threshold</span> <span class="o">=</span> <span class="nx">threshold</span> <span class="o">||</span> <span class="mf">0.2</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">callback</span> <span class="o">=</span> <span class="nx">callback</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">lastValues</span> <span class="o">=</span> <span class="p">[];</span>

<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">DiscontinuityDetector</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Default callback.  Logs the size and position of the discontinuity.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number</em> size The size of the discontinuity.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> channel The index of the channel the samples were found in.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> index The sample index the discontinuity was found at.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">DiscontinuityDetector</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">callback</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">size</span><span class="p">,</span> <span class="nx">channel</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Discontinuity of &#39;</span> <span class="o">+</span> <span class="nx">size</span> <span class="o">+</span> <span class="s1">&#39; detected on channel &#39;</span> <span class="o">+</span>
                  <span class="nx">channel</span> <span class="o">+</span> <span class="s1">&#39; index &#39;</span> <span class="o">+</span> <span class="nx">index</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">DiscontinuityDetector</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span>
                                                    <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">lastValues</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">lastValues</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">lastValues</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">threshold</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">threshold</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">channel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&gt;=</span> <span class="nx">lastValues</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">lastValues</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">lastValue</span> <span class="o">=</span> <span class="nx">lastValues</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>

        <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">channel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">lastValue</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">lastValue</span> <span class="o">-</span> <span class="nx">value</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nx">threshold</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">callback</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">lastValue</span> <span class="o">-</span> <span class="nx">value</span><span class="p">),</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="nx">lastValue</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">lastValues</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">lastValue</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">DiscontinuityDetector</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Discontinuity Detector&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>BadValueDetector</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/BadValueDetector.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Detect potentially hazardous values in the audio stream.  Looks for
undefineds, nulls, NaNs and Infinities.</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Audio</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> PassThroughNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Function</em> [callback] Function called if a bad value is detected.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">BadValueDetector</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">PassThroughNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">callback</span> <span class="o">=</span> <span class="nx">callback</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">BadValueDetector</span><span class="p">,</span> <span class="nx">PassThroughNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Default callback.  Logs the value and position of the bad value.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Number|Object|'undefined'</em> value The value detected.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> channel The index of the channel the value was found in.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> index The sample index the value was found at.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BadValueDetector</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">callback</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">channel</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">value</span> <span class="o">+</span> <span class="s1">&#39; detected at channel &#39;</span> <span class="o">+</span> <span class="nx">channel</span> <span class="o">+</span> <span class="s1">&#39; index &#39;</span> <span class="o">+</span>
                  <span class="nx">index</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BadValueDetector</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">channel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>

        <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">channel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">value</span> <span class="o">==</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">||</span>
                <span class="nx">value</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span>
                <span class="nb">isNaN</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">||</span>
                <span class="nx">value</span> <span class="o">==</span> <span class="kc">Infinity</span> <span class="o">||</span>
                <span class="nx">value</span> <span class="o">==</span> <span class="o">-</span><span class="kc">Infinity</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">callback</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">BadValueDetector</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Bad Value Detector&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>TriggerControl</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/dsp/TriggerControl.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Simple trigger which allows you to set a single sample to be 1 at the start
of a processing block</p>

<p><strong>Outputs</strong></p>

<ul>
<li>Triggers</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>trigger Set to 1 to fire a trigger.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [trigger=0] The initial trigger state.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">TriggerControl</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">trigger</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">trigger</span> <span class="o">||</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">TriggerControl</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">TriggerControl</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">buffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">channel</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">triggerParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">trigger</span> <span class="o">=</span> <span class="nx">triggerParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>

    <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">trigger</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">channel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="nx">triggerParameter</span><span class="p">.</span><span class="nx">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
            <span class="nx">trigger</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="nx">channel</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">TriggerControl</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Trigger Control&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                
            </div>
            <div class="section">
                <div class="header block">
                    <div class="left">
                        <div>
                            <h2>Operators</h2>
                        </div>
                    </div>
                    <div class="right">
                        <div><p>Mathematical operator nodes</p>
</div>
                    </div>
                    <div class="clear"></div>
                </div>

                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Add</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/operators/Add.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Add values</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio 1</li>
<li>Audio 2</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Summed audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>value The value to add.  Linked to input 1.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [value=0] The initial value to add.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Add</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">value</span> <span class="o">||</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Add</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Add</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">valueParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">valueChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">valueParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">value</span> <span class="o">=</span> <span class="nx">valueParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">valueChannel</span> <span class="o">=</span> <span class="nx">valueParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">valueChannel</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">value</span> <span class="o">=</span> <span class="nx">valueChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">+</span> <span class="nx">value</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Add</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Add&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Subtract</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/operators/Subtract.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Subtract values</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio 1</li>
<li>Audio 2</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Subtracted audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>value The value to subtract.  Linked to input 1.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [value=0] The initial value to subtract.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Subtract</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">value</span> <span class="o">||</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Subtract</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Subtract</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">valueParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">valueChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">valueParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">value</span> <span class="o">=</span> <span class="nx">valueParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">valueChannel</span> <span class="o">=</span> <span class="nx">valueParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">valueChannel</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">value</span> <span class="o">=</span> <span class="nx">valueChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">-</span> <span class="nx">value</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Subtract</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Subtract&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Multiply</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/operators/Multiply.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Multiply values</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio 1</li>
<li>Audio 2</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Multiplied audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>value The value to multiply by.  Linked to input 1.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [value=1] The initial value to multiply by.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Multiply</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">value</span> <span class="o">||</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Multiply</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Multiply</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">valueParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">valueChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">valueParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">value</span> <span class="o">=</span> <span class="nx">valueParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">valueChannel</span> <span class="o">=</span> <span class="nx">valueParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">valueChannel</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">value</span> <span class="o">=</span> <span class="nx">valueChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">*</span> <span class="nx">value</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Multiply</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Multiply&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Divide</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/operators/Divide.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Divide values</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio 1</li>
<li>Audio 2</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Divided audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>value The value to divide by.  Linked to input 1.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [value=1] The initial value to divide by.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Divide</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">value</span> <span class="o">||</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Divide</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Divide</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">valueParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">valueChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">valueParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">value</span> <span class="o">=</span> <span class="nx">valueParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">valueChannel</span> <span class="o">=</span> <span class="nx">valueParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">valueChannel</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">value</span> <span class="o">=</span> <span class="nx">valueChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">/</span> <span class="nx">value</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Divide</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Divide&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Modulo</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/operators/Modulo.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Modulo values</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio 1</li>
<li>Audio 2</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Moduloed audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>value The value to modulo by.  Linked to input 1.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [value=1] The initial value to modulo by.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Modulo</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">value</span> <span class="o">||</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Modulo</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Modulo</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">valueParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">valueChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">valueParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">value</span> <span class="o">=</span> <span class="nx">valueParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">valueChannel</span> <span class="o">=</span> <span class="nx">valueParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">valueChannel</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">value</span> <span class="o">=</span> <span class="nx">valueChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">%</span> <span class="nx">value</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Modulo</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Modulo&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Reciprocal</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/operators/Reciprocal.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Reciprocal (1/x) of values</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Reciprocal audio</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Reciprocal</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Reciprocal</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Reciprocal</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Reciprocal</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Reciprocal&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>MulAdd</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/operators/MulAdd.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Multiply and add values</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
<li>Multiply audio</li>
<li>Add audio</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>MulAdded audio</li>
</ul>

<p><strong>Parameters</strong></p>

<ul>
<li>mul The value to multiply by.  Linked to input 1.</li>
<li>add The value to add.  Linked to input 2.</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [mul=1] The initial value to multiply by.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [add=0] The initial value to add.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">MulAdd</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">,</span> <span class="nx">mul</span><span class="p">,</span> <span class="nx">add</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">mul</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">mul</span> <span class="o">||</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">add</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioletParameter</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">add</span> <span class="o">||</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">MulAdd</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">MulAdd</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Local processing variables</span>
    <span class="kd">var</span> <span class="nx">mulParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">mul</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">mul</span><span class="p">,</span> <span class="nx">mulChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">mulParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">mul</span> <span class="o">=</span> <span class="nx">mulParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">mulChannel</span> <span class="o">=</span> <span class="nx">mulParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">addParameter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">add</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">add</span><span class="p">,</span> <span class="nx">addChannel</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">addParameter</span><span class="p">.</span><span class="nx">isStatic</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">add</span> <span class="o">=</span> <span class="nx">addParameter</span><span class="p">.</span><span class="nx">getValue</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">addChannel</span> <span class="o">=</span> <span class="nx">addParameter</span><span class="p">.</span><span class="nx">getChannel</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">mulChannel</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">mul</span> <span class="o">=</span> <span class="nx">mulChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">addChannel</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">add</span> <span class="o">=</span> <span class="nx">addChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">*</span> <span class="nx">mul</span> <span class="o">+</span> <span class="nx">add</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">MulAdd</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;Multiplier/Adder&#39;</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Tanh</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/operators/Tanh.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Hyperbolic tangent of values.  Works nicely as a distortion function.</p>

<p><strong>Inputs</strong></p>

<ul>
<li>Audio</li>
</ul>

<p><strong>Outputs</strong></p>

<ul>
<li>Tanh audio</li>
</ul>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> AudioletNode
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Audiolet</em> audiolet The audiolet object.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Tanh</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">audiolet</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AudioletNode</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">audiolet</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">linkNumberOfOutputChannels</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">Tanh</span><span class="p">,</span> <span class="nx">AudioletNode</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Process a block of samples</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> inputBuffers Samples received from the inputs.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>AudioletBuffer[]</em> outputBuffers Samples to be sent to the outputs.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Tanh</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">generate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputBuffers</span><span class="p">,</span> <span class="nx">outputBuffers</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inputBuffer</span> <span class="o">=</span> <span class="nx">inputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">outputBuffer</span> <span class="o">=</span> <span class="nx">outputBuffers</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">numberOfChannels</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">numberOfChannels</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numberOfChannels</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">inputChannel</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">outputChannel</span> <span class="o">=</span> <span class="nx">outputBuffer</span><span class="p">.</span><span class="nx">getChannelData</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">bufferLength</span> <span class="o">=</span> <span class="nx">inputBuffer</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">bufferLength</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">inputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="nx">outputChannel</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">-</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="o">-</span><span class="nx">value</span><span class="p">))</span> <span class="o">/</span>
                <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="o">-</span><span class="nx">value</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>toString</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>String</em> String representation.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Tanh</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;Tanh&#39;</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                
            </div>
            <div class="section">
                <div class="header block">
                    <div class="left">
                        <div>
                            <h2>Scales</h2>
                        </div>
                    </div>
                    <div class="right">
                        <div><p>Musical scales</p>
</div>
                    </div>
                    <div class="clear"></div>
                </div>

                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Scale</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/scale/Scale.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Representation of a generic musical scale.  Can be subclassed to produce
specific scales.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number[]</em> degrees Array of integer degrees.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Tuning</em> [tuning] The scale's tuning. Defaults to 12-tone ET.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Scale</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">degrees</span><span class="p">,</span> <span class="nx">tuning</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">degrees</span> <span class="o">=</span> <span class="nx">degrees</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">tuning</span> <span class="o">=</span> <span class="nx">tuning</span> <span class="o">||</span> <span class="k">new</span> <span class="nx">EqualTemperamentTuning</span><span class="p">(</span><span class="mi">12</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Get the frequency of a note in the scale.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> degree The note's degree.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> rootFrequency The root frequency of the scale.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> octave The octave of the note.
                                    </li>
                                    <li>
                                        <strong>return</strong> <em>Number</em> The frequency of the note in hz.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Scale</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getFrequency</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">degree</span><span class="p">,</span> <span class="nx">rootFrequency</span><span class="p">,</span> <span class="nx">octave</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">frequency</span> <span class="o">=</span> <span class="nx">rootFrequency</span><span class="p">;</span>
    <span class="nx">octave</span> <span class="o">+=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">degree</span> <span class="o">/</span> <span class="k">this</span><span class="p">.</span><span class="nx">degrees</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
    <span class="nx">degree</span> <span class="o">%=</span> <span class="k">this</span><span class="p">.</span><span class="nx">degrees</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="nx">frequency</span> <span class="o">*=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">tuning</span><span class="p">.</span><span class="nx">octaveRatio</span><span class="p">,</span> <span class="nx">octave</span><span class="p">);</span>
    <span class="nx">frequency</span> <span class="o">*=</span> <span class="k">this</span><span class="p">.</span><span class="nx">tuning</span><span class="p">.</span><span class="nx">ratios</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">degrees</span><span class="p">[</span><span class="nx">degree</span><span class="p">]];</span>
    <span class="k">return</span> <span class="nx">frequency</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>MajorScale</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/scale/MajorScale.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Major scale.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> Scale
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">MajorScale</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">Scale</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">]);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">MajorScale</span><span class="p">,</span> <span class="nx">Scale</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>MinorScale</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/scale/MinorScale.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Minor scale.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> Scale
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">MinorScale</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">Scale</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">]);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">MinorScale</span><span class="p">,</span> <span class="nx">Scale</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                
            </div>
            <div class="section">
                <div class="header block">
                    <div class="left">
                        <div>
                            <h2>Tunings</h2>
                        </div>
                    </div>
                    <div class="right">
                        <div><p>Musical tunings</p>
</div>
                    </div>
                    <div class="clear"></div>
                </div>

                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Tuning</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/tuning/Tuning.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Representation of a generic musical tuning.  Can be subclassed to produce
specific tunings.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number[]</em> semitones Array of semitone values for the tuning.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [octaveRatio=2] Frequency ratio for notes an octave apart.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Tuning</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">semitones</span><span class="p">,</span> <span class="nx">octaveRatio</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">semitones</span> <span class="o">=</span> <span class="nx">semitones</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">octaveRatio</span> <span class="o">=</span> <span class="nx">octaveRatio</span> <span class="o">||</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">ratios</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">tuningLength</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">semitones</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">tuningLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">ratios</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">semitones</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">/</span> <span class="nx">tuningLength</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>EqualTemeperamentTuning</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/tuning/EqualTemeperamentTuning.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Equal temperament tuning.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> Tuning
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> pitchesPerOctave The number of notes in each octave.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">EqualTemperamentTuning</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">pitchesPerOctave</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">semitones</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">pitchesPerOctave</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">semitones</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">Tuning</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">semitones</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">EqualTemperamentTuning</span><span class="p">,</span> <span class="nx">Tuning</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                
            </div>
            <div class="section">
                <div class="header block">
                    <div class="left">
                        <div>
                            <h2>Patterns</h2>
                        </div>
                    </div>
                    <div class="right">
                        <div><p>Schedulable patterns of values</p>
</div>
                    </div>
                    <div class="clear"></div>
                </div>

                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>Pattern</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/pattern/Pattern.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>A generic pattern.  Patterns are simple classes which return the next value
in a sequence when the next function is called.  Patterns can be embedded
inside other patterns to produce complex sequences of values.  When a
pattern is finished its next function returns null.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Pattern</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Default next function.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>null</em> Null.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Pattern</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">next</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Return the current value of an item contained in a pattern.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>param</strong> <em>Pattern|Object</em> The item.
                                    </li>
                                    <li>
                                        <strong>return</strong> <em>Object</em> The value of the item.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Pattern</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">valueOf</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">item</span> <span class="k">instanceof</span> <span class="nx">Pattern</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">next</span><span class="p">());</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="nx">item</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Default reset function.</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">Pattern</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">reset</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>PSequence</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/pattern/PSequence.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Iterate through a list of values.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> Pattern
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Object[]</em> list Array of values.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [repeats=1] Number of times to loop through the array.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [offset=0] Index to start from.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">PSequence</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">list</span><span class="p">,</span> <span class="nx">repeats</span><span class="p">,</span> <span class="nx">offset</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Pattern</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">list</span> <span class="o">=</span> <span class="nx">list</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">repeats</span> <span class="o">=</span> <span class="nx">repeats</span> <span class="o">||</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">offset</span> <span class="o">=</span> <span class="nx">offset</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">PSequence</span><span class="p">,</span> <span class="nx">Pattern</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Generate the next value in the pattern.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>Number</em> The next value.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">PSequence</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">next</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">returnValue</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">repeats</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">offset</span><span class="p">)</span> <span class="o">%</span> <span class="k">this</span><span class="p">.</span><span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">list</span><span class="p">[</span><span class="nx">index</span><span class="p">];</span>
        <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">valueOf</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">item</span> <span class="k">instanceof</span> <span class="nx">Pattern</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">returnValue</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">item</span> <span class="k">instanceof</span> <span class="nx">Pattern</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">item</span><span class="p">.</span><span class="nx">reset</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="nx">returnValue</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">next</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">returnValue</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Reset the pattern</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">PSequence</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">reset</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">list</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">item</span> <span class="k">instanceof</span> <span class="nx">Pattern</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">item</span><span class="p">.</span><span class="nx">reset</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Supercollider alias</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Pseq</span> <span class="o">=</span> <span class="nx">PSequence</span><span class="p">;</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>PSeries</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/pattern/PSeries.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Iterate through a list of values.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> Pattern
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Object[]</em> list Array of values.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [repeats=1] Number of values to generate.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [offset=0] Index to start from.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">PSeries</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">list</span><span class="p">,</span> <span class="nx">repeats</span><span class="p">,</span> <span class="nx">offset</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Pattern</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">list</span> <span class="o">=</span> <span class="nx">list</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">repeats</span> <span class="o">=</span> <span class="nx">repeats</span> <span class="o">||</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">offset</span> <span class="o">=</span> <span class="nx">offset</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">PSeries</span><span class="p">,</span> <span class="nx">Pattern</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Generate the next value in the pattern.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>Number</em> The next value.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">PSeries</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">next</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">returnValue</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">repeats</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">offset</span><span class="p">)</span> <span class="o">%</span> <span class="k">this</span><span class="p">.</span><span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">list</span><span class="p">[</span><span class="nx">index</span><span class="p">];</span>
        <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">valueOf</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">item</span> <span class="k">instanceof</span> <span class="nx">Pattern</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">returnValue</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">item</span> <span class="k">instanceof</span> <span class="nx">Pattern</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">item</span><span class="p">.</span><span class="nx">reset</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="nx">returnValue</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">next</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">returnValue</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Reset the pattern</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">PSeries</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">reset</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">list</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">item</span> <span class="k">instanceof</span> <span class="nx">Pattern</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">item</span><span class="p">.</span><span class="nx">reset</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Supercollider alias</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Pser</span> <span class="o">=</span> <span class="nx">PSeries</span><span class="p">;</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>PShuffle</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/pattern/PShuffle.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Reorder an array, then iterate through it's values.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> Pattern
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Object[]</em> list Array of values.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> repeats Number of times to loop through the array.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">PShuffle</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">list</span><span class="p">,</span> <span class="nx">repeats</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Pattern</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">list</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="c1">// Shuffle values into new list</span>
    <span class="k">while</span> <span class="p">(</span><span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">list</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">list</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">repeats</span> <span class="o">=</span> <span class="nx">repeats</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">PShuffle</span><span class="p">,</span> <span class="nx">Pattern</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Generate the next value in the pattern.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>Number</em> The next value.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">PShuffle</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">next</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">returnValue</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">repeats</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">offset</span><span class="p">)</span> <span class="o">%</span> <span class="k">this</span><span class="p">.</span><span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">list</span><span class="p">[</span><span class="nx">index</span><span class="p">];</span>
        <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">valueOf</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">item</span> <span class="k">instanceof</span> <span class="nx">Pattern</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">returnValue</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">item</span> <span class="k">instanceof</span> <span class="nx">Pattern</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">item</span><span class="p">.</span><span class="nx">reset</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="nx">returnValue</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">next</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">returnValue</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Supercollider alias</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Pshuffle</span> <span class="o">=</span> <span class="nx">PShuffle</span><span class="p">;</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>PArithmetic</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/pattern/PArithmetic.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Arithmetic sequence.  Adds a value to a running total on each next call.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> Pattern
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> start Starting value.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Pattern|Number</em> step Value to add.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> repeats Number of values to generate.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">PArithmetic</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">step</span><span class="p">,</span> <span class="nx">repeats</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Pattern</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">start</span> <span class="o">=</span> <span class="nx">start</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">start</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">step</span> <span class="o">=</span> <span class="nx">step</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">repeats</span> <span class="o">=</span> <span class="nx">repeats</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">PArithmetic</span><span class="p">,</span> <span class="nx">Pattern</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Generate the next value in the pattern.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>Number</em> The next value.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">PArithmetic</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">next</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">returnValue</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">returnValue</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">repeats</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">step</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">valueOf</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">step</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">step</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">value</span> <span class="o">+=</span> <span class="nx">step</span><span class="p">;</span>
            <span class="nx">returnValue</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="nx">returnValue</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">returnValue</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Reset the pattern</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">PArithmetic</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">reset</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">start</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">step</span> <span class="k">instanceof</span> <span class="nx">Pattern</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">step</span><span class="p">.</span><span class="nx">reset</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Supercollider alias</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Pseries</span> <span class="o">=</span> <span class="nx">PArithmetic</span><span class="p">;</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>PGeometric</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/pattern/PGeometric.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Geometric sequence.  Multiplies a running total by a value on each next
call.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> Pattern
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> start Starting value.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Pattern|Number</em> step Value to multiply by.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> repeats Number of values to generate.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">PGeometric</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">step</span><span class="p">,</span> <span class="nx">repeats</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Pattern</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">start</span> <span class="o">=</span> <span class="nx">start</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">start</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">step</span> <span class="o">=</span> <span class="nx">step</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">repeats</span> <span class="o">=</span> <span class="nx">repeats</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">PGeometric</span><span class="p">,</span> <span class="nx">Pattern</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Generate the next value in the pattern.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>Number</em> The next value.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">PGeometric</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">next</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">returnValue</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">returnValue</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">repeats</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">step</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">valueOf</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">step</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">step</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">value</span> <span class="o">*=</span> <span class="nx">step</span><span class="p">;</span>
            <span class="nx">returnValue</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="nx">returnValue</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">returnValue</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Reset the pattern</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">PGeometric</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">reset</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">start</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">step</span> <span class="k">instanceof</span> <span class="nx">Pattern</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">step</span><span class="p">.</span><span class="nx">reset</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Supercollider alias</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Pgeom</span> <span class="o">=</span> <span class="nx">PGeometric</span><span class="p">;</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>PChoose</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/pattern/PChoose.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Choose a random value from an array.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> Pattern
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Object[]</em> list Array of items to choose from.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> [repeats=1] Number of values to generate.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">PChoose</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">list</span><span class="p">,</span> <span class="nx">repeats</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Pattern</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">list</span> <span class="o">=</span> <span class="nx">list</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">repeats</span> <span class="o">=</span> <span class="nx">repeats</span> <span class="o">||</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">PChoose</span><span class="p">,</span> <span class="nx">Pattern</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Generate the next value in the pattern.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>Number</em> The next value.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">PChoose</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">next</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">returnValue</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">repeats</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">list</span><span class="p">[</span><span class="nx">index</span><span class="p">];</span>
        <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">valueOf</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">item</span> <span class="k">instanceof</span> <span class="nx">Pattern</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">returnValue</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">item</span> <span class="k">instanceof</span> <span class="nx">Pattern</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">item</span><span class="p">.</span><span class="nx">reset</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="nx">returnValue</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">next</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">returnValue</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Reset the pattern</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">PChoose</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">reset</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">list</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">item</span> <span class="k">instanceof</span> <span class="nx">Pattern</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">item</span><span class="p">.</span><span class="nx">reset</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Supercollider alias</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Prand</span> <span class="o">=</span> <span class="nx">PChoose</span><span class="p">;</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>PRandom</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/pattern/PRandom.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Sequence of random numbers.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> Pattern
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number|Pattern</em> low Lowest possible value.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number|Pattern</em> high Highest possible value.
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Number</em> repeats Number of values to generate.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">PRandom</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">low</span><span class="p">,</span> <span class="nx">high</span><span class="p">,</span> <span class="nx">repeats</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Pattern</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">low</span> <span class="o">=</span> <span class="nx">low</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">high</span> <span class="o">=</span> <span class="nx">high</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">repeats</span> <span class="o">=</span> <span class="nx">repeats</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">PRandom</span><span class="p">,</span> <span class="nx">Pattern</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Generate the next value in the pattern.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>Number</em> The next value.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">PRandom</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">next</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">returnValue</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">repeats</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">low</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">valueOf</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">low</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">high</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">valueOf</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">high</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">low</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">high</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">value</span> <span class="o">*=</span> <span class="nx">step</span><span class="p">;</span>
            <span class="nx">returnValue</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="nx">returnValue</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">returnValue</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Reset the pattern</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">PRandom</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">reset</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Supercollider alias</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Pwhite</span> <span class="o">=</span> <span class="nx">PRandom</span><span class="p">;</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                <!-- Title and filename -->
                <div class="file">
                    <div class="header block">
                        <div class="left">
                            <div>
                                <h3>PProxy</h3>
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                ../trunk/src/pattern/PProxy.js
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                <!-- File contents -->
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Proxy pattern.  Holds a pattern which can safely be replaced by a different
pattern while it is running.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>constructor</strong>
                                    </li>
                                    <li>
                                        <strong>extends</strong> Pattern
                                    </li>
                                    <li>
                                        <strong>param</strong> <em>Pattern</em> pattern The initial pattern.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">PProxy</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">pattern</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Pattern</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">pattern</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">pattern</span> <span class="o">=</span> <span class="nx">pattern</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="nx">extend</span><span class="p">(</span><span class="nx">PProxy</span><span class="p">,</span> <span class="nx">Pattern</span><span class="p">);</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Generate the next value in the pattern.</p>

                                <hr />
                                <ul>
                                    <li>
                                        <strong>return</strong> <em>Number</em> The next value.
                                    </li>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="nx">PProxy</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">next</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">returnValue</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">pattern</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">returnValue</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">pattern</span><span class="p">.</span><span class="nx">next</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nx">returnValue</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">returnValue</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div class="content block">
                        <div class="left">
                            <div>
                                <p>Alias</p>

                                <hr />
                                <ul>
                                    
                                </ul>
                                
                            </div>
                        </div>
                        <div class="right">
                            <div>
                                <div class="highlight"><pre><span class="kd">var</span> <span class="nx">Pp</span> <span class="o">=</span> <span class="nx">PProxy</span><span class="p">;</span>
</pre></div>

                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                </div>
                
            </div>
            
        </div>
    </body>
</html>
